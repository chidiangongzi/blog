<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>毕业脚本整理 | 是睿睿吖</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="K值与SSE关系线">
<meta property="og:type" content="article">
<meta property="og:title" content="毕业脚本整理">
<meta property="og:url" content="http://chidiangongzi.github.io/blog/2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/index.html">
<meta property="og:site_name" content="是睿睿吖">
<meta property="og:description" content="K值与SSE关系线">
<meta property="og:locale" content="ch">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/K%E5%80%BC%E4%B8%8ESSE%E5%85%B3%E7%B3%BB%E7%BA%BF/SSE-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E5%90%84%E5%8F%98%E9%87%8F%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%9B%BE/para-time-K=0_0-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E6%8A%95%E5%BD%B1%E7%BB%98%E5%9B%BE/kmeans-latitude-K=1-1-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E6%95%A3%E7%82%B9%E5%9B%BE/scatter-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%9B%9B%E7%BB%84CCN%E7%9A%84%E7%AE%B1%E7%BA%BF%E5%9B%BE/W-box-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E6%9F%B1%E7%8A%B6%E5%9B%BE-%E5%AD%90%E5%9B%BE/bar-ccn%25-%E4%BE%8B%E5%9B%BE.png">
<meta property="og:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E9%9B%B9%E8%83%9A%E7%AD%89%E5%80%BC%E7%BA%BF+%E4%B8%8A%E5%8D%87%E6%B0%94%E6%B5%81%E5%9B%BE/dzx-qg-%E4%BE%8B%E5%9B%BE.png">
<meta property="article:published_time" content="2022-06-21T03:16:49.000Z">
<meta property="article:modified_time" content="2022-06-22T08:38:25.199Z">
<meta property="article:author" content="pro^w^">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://chidiangongzi.github.io/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/K%E5%80%BC%E4%B8%8ESSE%E5%85%B3%E7%B3%BB%E7%BA%BF/SSE-%E4%BE%8B%E5%9B%BE.png">
  
    <link rel="alternate" href="/blog/atom.xml" title="是睿睿吖" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    
  
  
<link rel="stylesheet" href="/blog/css/style.css">

  

<meta name="generator" content="Hexo 4.2.1"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    
    <div id="header-inner" class="inner">
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/blog/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://chidiangongzi.github.io/blog"></form>
      </div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/blog/">首页</a>
        
          <a class="main-nav-link" href="/blog/archives">归档</a>
        
          <a class="main-nav-link" href="/blog/about">关于</a>
        
      </nav>
      
    </div>
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/blog/" id="logo">是睿睿吖</a>
      </h1>
      
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-毕业脚本整理" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/blog/2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/" class="article-date">
  <time datetime="2022-06-21T03:16:49.000Z" itemprop="datePublished">2022-06-21</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      毕业脚本整理
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <!-- Table of Contents -->
        
        <iframe src="https://nbviewer.org/github/zxdawn/GEOSChem-python-tutorial/blob/master/Chapter00_basic_python.ipynb" width="1000" height="4000"></iframe>

<h3 id="K值与SSE关系线"><a href="#K值与SSE关系线" class="headerlink" title="K值与SSE关系线"></a>K值与SSE关系线</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/K%E5%80%BC%E4%B8%8ESSE%E5%85%B3%E7%B3%BB%E7%BA%BF/SSE-%E4%BE%8B%E5%9B%BE.png" class>
<a id="more"></a>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.pyplot <span class="keyword">import</span> MultipleLocator</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> interp1d</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> mpatches</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> interpolate</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正规化数据集 X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span><span class="params">(X, axis=<span class="number">-1</span>, p=<span class="number">2</span>)</span>:</span></span><br><span class="line">    lp_norm = np.atleast_1d(np.linalg.norm(X, p, axis))</span><br><span class="line">    lp_norm[lp_norm == <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> X / np.expand_dims(lp_norm, axis)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算一个样本与数据集中所有样本的欧氏距离的平方</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">euclidean_distance</span><span class="params">(one_sample, X)</span>:</span></span><br><span class="line">    one_sample = one_sample.reshape(<span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line">    X = X.reshape(X.shape[<span class="number">0</span>], <span class="number">-1</span>)</span><br><span class="line">    distances = np.power(np.tile(one_sample, (X.shape[<span class="number">0</span>], <span class="number">1</span>)) - X,</span><br><span class="line">                         <span class="number">2</span>).sum(axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> distances</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Kmeans</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Kmeans聚类算法.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">	Parameters:</span></span><br><span class="line"><span class="string">	-----------</span></span><br><span class="line"><span class="string">	k: int</span></span><br><span class="line"><span class="string">		聚类的数目.</span></span><br><span class="line"><span class="string">	max_iterations: int</span></span><br><span class="line"><span class="string">		最大迭代次数. </span></span><br><span class="line"><span class="string">	varepsilon: float</span></span><br><span class="line"><span class="string">		判断是否收敛, 如果上一次的所有k个聚类中心与本次的所有k个聚类中心的差都小于varepsilon, </span></span><br><span class="line"><span class="string">		则说明算法已经收敛</span></span><br><span class="line"><span class="string">	"""</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, k=<span class="number">2</span>, max_iterations=<span class="number">500</span>, varepsilon=<span class="number">0.0001</span>)</span>:</span></span><br><span class="line">        self.k = k</span><br><span class="line">        self.max_iterations = max_iterations</span><br><span class="line">        self.varepsilon = varepsilon</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 从所有样本中随机选取self.k样本作为初始的聚类中心</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_random_centroids</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        n_samples, n_features = np.shape(X)</span><br><span class="line">        centroids = np.zeros((self.k, n_features))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.k):</span><br><span class="line">            centroid = X[np.random.choice(range(n_samples))]</span><br><span class="line">            centroids[i] = centroid</span><br><span class="line">        <span class="keyword">return</span> centroids</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回距离该样本最近的一个中心索引[0, self.k)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_closest_centroid</span><span class="params">(self, sample, centroids)</span>:</span></span><br><span class="line">        distances = euclidean_distance(sample, centroids)</span><br><span class="line">        closest_i = np.argmin(distances)</span><br><span class="line">        <span class="keyword">return</span> closest_i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将所有样本进行归类，归类规则就是将该样本归类到与其最近的中心</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_clusters</span><span class="params">(self, centroids, X)</span>:</span></span><br><span class="line">        n_samples = np.shape(X)[<span class="number">0</span>]</span><br><span class="line">        clusters = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.k)]</span><br><span class="line">        <span class="keyword">for</span> sample_i, sample <span class="keyword">in</span> enumerate(X):</span><br><span class="line">            centroid_i = self._closest_centroid(sample, centroids)</span><br><span class="line">            clusters[centroid_i].append(sample_i)</span><br><span class="line">        <span class="keyword">return</span> clusters</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对中心进行更新</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update_centroids</span><span class="params">(self, clusters, X)</span>:</span></span><br><span class="line">        n_features = np.shape(X)[<span class="number">1</span>]</span><br><span class="line">        centroids = np.zeros((self.k, n_features))</span><br><span class="line">        <span class="keyword">for</span> i, cluster <span class="keyword">in</span> enumerate(clusters):</span><br><span class="line">            centroid = np.mean(X[cluster], axis=<span class="number">0</span>)</span><br><span class="line">            centroids[i] = centroid</span><br><span class="line">        <span class="keyword">return</span> centroids</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将所有样本进行归类，其所在的类别的索引就是其类别标签</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cluster_labels</span><span class="params">(self, clusters, X)</span>:</span></span><br><span class="line">        y_pred = np.zeros(np.shape(X)[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> cluster_i, cluster <span class="keyword">in</span> enumerate(clusters):</span><br><span class="line">            <span class="keyword">for</span> sample_i <span class="keyword">in</span> cluster:</span><br><span class="line">                y_pred[sample_i] = cluster_i</span><br><span class="line">        <span class="keyword">return</span> y_pred</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对整个数据集X进行Kmeans聚类，返回其聚类的标签</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        <span class="comment"># 从所有样本中随机选取self.k样本作为初始的聚类中心</span></span><br><span class="line">        centroids = self.init_random_centroids(X)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 迭代，直到算法收敛(上一次的聚类中心和这一次的聚类中心几乎重合)或者达到最大迭代次数</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.max_iterations):</span><br><span class="line">            <span class="comment"># 将所有进行归类，归类规则就是将该样本归类到与其最近的中心</span></span><br><span class="line">            clusters = self.create_clusters(centroids, X)</span><br><span class="line">            former_centroids = centroids</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 计算新的聚类中心</span></span><br><span class="line">            centroids = self.update_centroids(clusters, X)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果聚类中心几乎没有变化，说明算法已经收敛，退出迭代</span></span><br><span class="line">            diff = centroids - former_centroids</span><br><span class="line">            <span class="keyword">if</span> diff.any() &lt; self.varepsilon:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.get_cluster_labels(clusters, X)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># define variable</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line">print(<span class="string">"nn="</span>, nn)</span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line">print(<span class="string">"nt="</span>, nt)</span><br><span class="line">first = np.empty([nt, nn], dtype=float)</span><br><span class="line">second = np.empty([nt, nn], dtype=float)</span><br><span class="line">third = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">ntt = <span class="number">92</span></span><br><span class="line">first[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">0</span>:ntt] / <span class="number">2</span>)</span><br><span class="line">second[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, ntt:<span class="number">2</span> * ntt] / <span class="number">2</span>)</span><br><span class="line">third[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">2</span> * ntt:<span class="number">3</span> * ntt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">3</span> * ntt:<span class="number">4</span> * ntt])</span><br><span class="line">traj = np.zeros((nn, nt, <span class="number">3</span>))</span><br><span class="line">traj[:, :, <span class="number">0</span>] = np.transpose(first)</span><br><span class="line">traj[:, :, <span class="number">1</span>] = np.transpose(second)</span><br><span class="line">traj[:, :, <span class="number">2</span>] = np.transpose(third)</span><br><span class="line">X = traj[:, :, :]</span><br><span class="line">XX = X.reshape((nn, nt * <span class="number">3</span>))</span><br><span class="line"></span><br><span class="line">SSE = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    km = KMeans(n_clusters=i)</span><br><span class="line">    km.fit(XX)</span><br><span class="line">    SSE.append(km.inertia_)</span><br><span class="line">print(<span class="string">"SSE="</span>, SSE)</span><br><span class="line">print(<span class="string">"SSE0="</span>, SSE[<span class="number">0</span>])</span><br><span class="line">xx = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line"><span class="comment">#plt.plot(xx, SSE)</span></span><br><span class="line">fig = plt.figure()</span><br><span class="line">ax = fig.gca()</span><br><span class="line">figure0 = ax.plot(xx, np.array(SSE) / <span class="number">1e9</span>)</span><br><span class="line"></span><br><span class="line">ax = plt.gca()</span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">1</span>)</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">1</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"><span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line">maxSSE = math.ceil(max(SSE) / <span class="number">1e9</span>)</span><br><span class="line">print(<span class="string">"maxSSE="</span>, math.ceil(max(SSE) / <span class="number">1e9</span>))</span><br><span class="line">plt.xlim(<span class="number">1</span>, <span class="number">10</span>, <span class="number">1</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, maxSSE, <span class="number">1</span>)</span><br><span class="line">ax.set_xlabel(<span class="string">"k"</span>, fontsize=<span class="number">18</span>, labelpad=<span class="number">10</span>)</span><br><span class="line">ax.set_xlim(<span class="number">1</span>, <span class="number">10</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">"SSE (e9)"</span>, fontsize=<span class="number">18</span>, labelpad=<span class="number">10</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>, maxSSE)</span><br><span class="line">plt.tight_layout() <span class="comment"># xlabel 坐标轴显示不全</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># print hail's diameter</span></span><br><span class="line">print(len(d))</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment">#-----------------------------------------------------------</span></span><br><span class="line">plt.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">plt.subplots_adjust(left=<span class="number">0.21</span>, bottom=<span class="number">0.185</span>)</span><br><span class="line"><span class="comment">#plt.subplots_adjust(left=0.05, bottom=0.1)</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.yaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.yaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"></span><br><span class="line"><span class="comment">#y_ticks = ax.set_yticks([36])</span></span><br><span class="line"><span class="comment">#y_labels = ax.set_yticklabels(["one"])</span></span><br><span class="line"></span><br><span class="line">plt.savefig(<span class="string">'./SSE.png'</span>, dpi=<span class="number">500</span>)</span><br><span class="line"><span class="comment">#plt.show()</span></span><br><span class="line">plt.close()</span><br></pre></td></tr></table></figure>
<h3 id="冰雹轨迹各变量时间序列图"><a href="#冰雹轨迹各变量时间序列图" class="headerlink" title="冰雹轨迹各变量时间序列图"></a>冰雹轨迹各变量时间序列图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E5%90%84%E5%8F%98%E9%87%8F%E6%97%B6%E9%97%B4%E5%BA%8F%E5%88%97%E5%9B%BE/para-time-K=0_0-%E4%BE%8B%E5%9B%BE.png" class>
<hr>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.axisartist.parasite_axes <span class="keyword">import</span> HostAxes, ParasiteAxes</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">make_patch_spines_invisible</span><span class="params">(ax)</span>:</span></span><br><span class="line">    ax.set_frame_on(<span class="literal">True</span>)</span><br><span class="line">    ax.patch.set_visible(<span class="literal">False</span>)</span><br><span class="line">    <span class="keyword">for</span> sp <span class="keyword">in</span> ax.spines.values():</span><br><span class="line">        sp.set_visible(<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">### 数据读取</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line">print(<span class="string">"nn="</span>, nn)</span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line">print(<span class="string">"nt="</span>, nt)</span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">dlt = np.empty([nt, nn], dtype=float)</span><br><span class="line">qc = np.empty([nt, nn], dtype=float)</span><br><span class="line">qr = np.empty([nt, nn], dtype=float)</span><br><span class="line">xw = np.empty([nt, nn], dtype=float)</span><br><span class="line">xt = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpc2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpr2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xphwet = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">hail = np.loadtxt(<span class="string">"./data/Hail-0.5.txt"</span>)</span><br><span class="line">hydro = np.loadtxt(<span class="string">"./data/Hydrometer-0.5.txt"</span>)</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line"></span><br><span class="line">dlt[<span class="number">0</span>:nt - <span class="number">2</span>, :] = (d[<span class="number">1</span>:nt - <span class="number">1</span>, :] - d[<span class="number">0</span>:nt - <span class="number">2</span>, :]) * <span class="number">60</span> / <span class="number">5</span></span><br><span class="line">dlt[nt - <span class="number">1</span>, :] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">qc[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">qr[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])</span><br><span class="line">xw[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">0.01</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">xt[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])<span class="number">-273.0</span></span><br><span class="line">xpc2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt])</span><br><span class="line">xpr2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">xphwet[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">4</span>*nt:<span class="number">5</span>*nt])</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 坐标更改，变量修改</span></span><br><span class="line"><span class="comment">#qr = 100 * qr</span></span><br><span class="line"><span class="comment">#xpc2h = 100 * xpc2h</span></span><br><span class="line"><span class="comment">#xpr2h = 100000 * xpr2h</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 获取y_pred</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># print hail's diameter</span></span><br><span class="line">print(len(d))</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># new a figure and set it into 3d</span></span><br><span class="line"><span class="comment"># draw the figure, the color is r = read</span></span><br><span class="line">dmax = np.array(d).max()</span><br><span class="line">dmin = np.array(d).min()</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first_2000[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            first_2000[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，min'</span></span><br><span class="line">xmax = np.array(first_2000).max()</span><br><span class="line">xmin = np.array(first_2000).min()</span><br><span class="line">print(<span class="string">'xmin='</span>, xmin, <span class="string">'  '</span>, <span class="string">'xmax='</span>, xmax)</span><br><span class="line">ymax = np.array(second_2000).max()</span><br><span class="line">ymin = np.array(second_2000).min()</span><br><span class="line">print(<span class="string">'ymin='</span>, ymin, <span class="string">'  '</span>, <span class="string">'ymax='</span>, ymax)</span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">mm = <span class="number">-1</span></span><br><span class="line"><span class="comment">#for i in range(nn):</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="comment">#for k in range(1):</span></span><br><span class="line"><span class="comment">#for k in range(2,3):</span></span><br><span class="line">    <span class="comment"># new a figure and set it into 3d</span></span><br><span class="line">    print(<span class="string">"K="</span>, k)</span><br><span class="line">    iw = np.where(y_pred[:] == order[k])</span><br><span class="line"></span><br><span class="line">    <span class="comment">### 计算大于0.1cm的时刻</span></span><br><span class="line">    it = np.empty([len(iw[<span class="number">0</span>])], dtype=int)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(iw[<span class="number">0</span>])):</span><br><span class="line">        <span class="comment">#        print("d[:,iw].shape=", d[:, iw].shape)</span></span><br><span class="line">        <span class="comment">#        print(np.where(d[:, iw][:, 0, i] &gt;= 0.1))</span></span><br><span class="line">        it[i] = min(min(np.where(d[:, iw][:, <span class="number">0</span>, i] &gt;= <span class="number">0.1</span>)))</span><br><span class="line"><span class="comment">#        if (it[i] &lt;= 10):</span></span><br><span class="line"><span class="comment">#            it[i] = 10</span></span><br><span class="line">    print(<span class="string">'it.shape='</span>, it.shape)</span><br><span class="line">    print(<span class="string">'iw.shape='</span>, iw[<span class="number">0</span>].shape)</span><br><span class="line">    <span class="comment">#    print('it=', it)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diwmax = np.amax(d[nt<span class="number">-1</span>, iw], axis=<span class="number">0</span>)</span><br><span class="line">    print(diwmax)</span><br><span class="line">    print(<span class="string">"diwmax.shape"</span>, diwmax.shape)</span><br><span class="line">    iwiw11 = <span class="number">999999</span></span><br><span class="line">    iwiw22 = <span class="number">999999</span></span><br><span class="line">    iwiw33 = <span class="number">999999</span></span><br><span class="line">    iwiw44 = <span class="number">999999</span></span><br><span class="line">    iwiw55 = <span class="number">999999</span></span><br><span class="line">    i11 = <span class="number">999999</span></span><br><span class="line">    i22 = <span class="number">999999</span></span><br><span class="line">    i33 = <span class="number">999999</span></span><br><span class="line">    i44 = <span class="number">999999</span></span><br><span class="line">    i55 = <span class="number">999999</span></span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt;= <span class="number">0.5</span>):</span><br><span class="line">        iwiw1 = np.where((diwmax[:] &gt;= <span class="number">0.5</span>) &amp; (diwmax[:] &lt;= <span class="number">1.0</span>))</span><br><span class="line">        iwiw11 = np.where(diwmax[:] == np.array(diwmax[iwiw1]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">1.0</span>):</span><br><span class="line">        iwiw2 = np.where((diwmax[:] &gt; <span class="number">1.0</span>) &amp; (diwmax[:] &lt;= <span class="number">1.5</span>))</span><br><span class="line">        iwiw22 = np.where(diwmax[:] == np.array(diwmax[iwiw2]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">1.5</span>):</span><br><span class="line">        iwiw3 = np.where((diwmax[:] &gt; <span class="number">1.5</span>) &amp; (diwmax[:] &lt;= <span class="number">2.0</span>))</span><br><span class="line">        iwiw33 = np.where(diwmax[:] == np.array(diwmax[iwiw3]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">2.0</span>):</span><br><span class="line">        iwiw4 = np.where((diwmax[:] &gt; <span class="number">2.0</span>) &amp; (diwmax[:] &lt;= <span class="number">2.5</span>))</span><br><span class="line">        iwiw44 = np.where(diwmax[:] == np.array(diwmax[iwiw4]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">2.5</span>):</span><br><span class="line">        iwiw5 = np.where((diwmax[:] &gt; <span class="number">2.5</span>))</span><br><span class="line">        iwiw55 = np.where(diwmax[:] == np.array(diwmax[iwiw5]).max())</span><br><span class="line">    <span class="keyword">if</span> (iwiw11 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw11"</span>, iwiw11[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"0.5-1.0cm最大直径"</span>, diwmax[iwiw11])</span><br><span class="line">        print(<span class="string">"0.5-1.0cm轨迹数"</span>, iwiw1[<span class="number">0</span>].shape)</span><br><span class="line">        <span class="comment">#print("iw", iw)</span></span><br><span class="line">        <span class="comment">#print("iw.shape", iw[0].shape)</span></span><br><span class="line">        i11 = iw[<span class="number">0</span>][iwiw11[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i11"</span>, i11)</span><br><span class="line">    <span class="keyword">if</span> (iwiw22 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw22"</span>, iwiw22[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"1.0-1.5cm最大直径"</span>, diwmax[iwiw22])</span><br><span class="line">        print(<span class="string">"1.0-1.5cm轨迹数"</span>, iwiw2[<span class="number">0</span>].shape)</span><br><span class="line">        i22 = iw[<span class="number">0</span>][iwiw22[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i22"</span>, i22)</span><br><span class="line">    <span class="keyword">if</span> (iwiw33 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw33"</span>, iwiw33[<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"1.5-2.0cm最大直径"</span>, diwmax[iwiw33])</span><br><span class="line">        print(<span class="string">"1.5-2.0cm轨迹数"</span>, iwiw3[<span class="number">0</span>].shape)</span><br><span class="line">        i33 = iw[<span class="number">0</span>][iwiw33[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i33"</span>, i33)</span><br><span class="line">    <span class="keyword">if</span> (iwiw44 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw44"</span>, iwiw44[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"2.0-2.5cm最大直径"</span>, diwmax[iwiw44])</span><br><span class="line">        print(<span class="string">"2.0-2.5cm轨迹数"</span>, iwiw4[<span class="number">0</span>].shape)</span><br><span class="line">        i44 = iw[<span class="number">0</span>][iwiw44[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i44"</span>, i44)</span><br><span class="line">    <span class="keyword">if</span> (iwiw55 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw55"</span>, iwiw55[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"&gt;2.5cm最大直径"</span>, diwmax[iwiw55])</span><br><span class="line">        print(<span class="string">"&gt;2.5cm-轨迹数"</span>, iwiw5[<span class="number">0</span>].shape)</span><br><span class="line">        i55 = iw[<span class="number">0</span>][iwiw55[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i55"</span>, i55)</span><br><span class="line">    print(<span class="string">'iw='</span>, iw[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">'iw.shape='</span>, iw[<span class="number">0</span>].shape)</span><br><span class="line">    dmaxiw5 = [iwiw11, iwiw22, iwiw33, iwiw44, iwiw55]</span><br><span class="line">    <span class="comment">#    print('y_pred.shape=', y_pred.shape)</span></span><br><span class="line">    <span class="comment">#    print('len=', len(iw[0]))</span></span><br><span class="line">    <span class="comment"># choose color for hail's diameter</span></span><br><span class="line">    <span class="comment">##iw = np.where(y_pred[:] == k)</span></span><br><span class="line">    <span class="comment">##maxd = max(max(d[nt - 1, iw]))</span></span><br><span class="line">    <span class="comment">## add</span></span><br><span class="line"></span><br><span class="line">    sn = [i11,i22,i33,i44,i55]</span><br><span class="line">    print(<span class="string">"sn="</span>,sn)</span><br><span class="line">    <span class="keyword">for</span> pp <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line"><span class="comment">#    for pp in range(1):</span></span><br><span class="line">        print(<span class="string">"pp="</span>,pp)</span><br><span class="line">        ss = sn[pp]</span><br><span class="line">        <span class="keyword">if</span> (ss == <span class="number">999999</span>):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        print(<span class="string">'iw='</span>, iw)</span><br><span class="line">        print(third_2000[:, ss])</span><br><span class="line">        nzz = np.array(third_2000[:,ss].min()) <span class="comment">### 最底层</span></span><br><span class="line"><span class="comment">#        ntt = min(min(np.where(third_2000[:, ss] &lt;= nzz)))</span></span><br><span class="line">        ntt = max(max(max(np.where(dlt[:, ss] &gt; <span class="number">0.0</span>))),min(min(np.where(third_2000[:, ss] &lt;= nzz))))</span><br><span class="line">        <span class="keyword">if</span> (np.array(d[:,ss]).min()&lt;=<span class="number">0.1</span>):</span><br><span class="line">            tt0_1 = max(max(np.where(d[:, ss] &lt;= <span class="number">0.11</span>))) <span class="comment"># 0.1cm对应时间</span></span><br><span class="line">        <span class="keyword">if</span> (np.array(d[:,ss]).min()&gt;<span class="number">0.1</span>):</span><br><span class="line">            tt0_1 = <span class="number">1</span></span><br><span class="line">        <span class="comment">#itt = int((ntt + 10) * 50 / 60) # 多10时刻空白的作为预留空间，itt表示分钟</span></span><br><span class="line">        itt = int((ntt + <span class="number">2</span>) * <span class="number">50</span> / <span class="number">60</span>) <span class="comment"># 多10时刻空白的作为预留空间，itt表示分钟</span></span><br><span class="line">        ntt = int(itt * <span class="number">60</span> / <span class="number">50</span>) <span class="comment">#itt分钟对应的矩阵时刻数</span></span><br><span class="line">        print(<span class="string">"itt="</span>,itt,<span class="string">"min"</span>)</span><br><span class="line">        print(<span class="string">"ntt="</span>,ntt)</span><br><span class="line">        <span class="comment">#----------------------------------------------------------</span></span><br><span class="line">        fig, ax_hei = plt.subplots(dpi=<span class="number">400</span>, figsize=(<span class="number">13</span>, <span class="number">5</span>)) <span class="comment">#设置画布长12宽4，分辨率为400</span></span><br><span class="line">        fig.subplots_adjust(left=<span class="number">0.07</span>, bottom=<span class="number">0.18</span>, right=<span class="number">0.48</span>, top=<span class="number">0.73</span>)</span><br><span class="line">        </span><br><span class="line">        ax_dia = ax_hei.twinx()</span><br><span class="line">        ax_dlt = ax_hei.twinx()</span><br><span class="line">        ax_cloud = ax_hei.twinx()</span><br><span class="line">        ax_rain = ax_hei.twinx()</span><br><span class="line">        ax_vcloud = ax_hei.twinx()</span><br><span class="line">        ax_vrain = ax_hei.twinx()</span><br><span class="line">        ax_wwind = ax_hei.twinx()</span><br><span class="line">        ax_tem = ax_hei.twinx()</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># Offset the right spine of par2.  The ticks and label have already been</span></span><br><span class="line">        <span class="comment"># placed on the right by twinx above.</span></span><br><span class="line">        ax_dia.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.0</span>))</span><br><span class="line">        ax_dlt.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.15</span>))</span><br><span class="line">        ax_cloud.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.30</span>))</span><br><span class="line">        ax_rain.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.45</span>))</span><br><span class="line">        ax_vcloud.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.60</span>))</span><br><span class="line">        ax_vrain.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.75</span>))</span><br><span class="line">        ax_wwind.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">1.90</span>))</span><br><span class="line">        ax_tem.spines[<span class="string">"right"</span>].set_position((<span class="string">"axes"</span>, <span class="number">2.08</span>))</span><br><span class="line">        <span class="comment"># Having been created by twinx, par2 has its frame off, so the line of its</span></span><br><span class="line">        <span class="comment"># detached spine is invisible.  First, activate the frame but make the patch</span></span><br><span class="line">        <span class="comment"># and spines invisible.</span></span><br><span class="line">        make_patch_spines_invisible(ax_dia)</span><br><span class="line">        make_patch_spines_invisible(ax_dlt)</span><br><span class="line">        make_patch_spines_invisible(ax_cloud)</span><br><span class="line">        make_patch_spines_invisible(ax_rain)</span><br><span class="line">        make_patch_spines_invisible(ax_vcloud)</span><br><span class="line">        make_patch_spines_invisible(ax_vrain)</span><br><span class="line">        make_patch_spines_invisible(ax_wwind)</span><br><span class="line">        make_patch_spines_invisible(ax_tem)</span><br><span class="line">        <span class="comment"># Second, show the right spine.</span></span><br><span class="line">        ax_hei.spines[<span class="string">"right"</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">        ax_hei.spines[<span class="string">"top"</span>].set_visible(<span class="literal">False</span>)</span><br><span class="line">        ax_dia.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_dlt.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_cloud.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_rain.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_vcloud.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_vrain.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_wwind.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        ax_tem.spines[<span class="string">"right"</span>].set_visible(<span class="literal">True</span>)</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#set label for axis</span></span><br><span class="line">        ax_hei.set_ylabel(<span class="string">'Height  (km)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_hei.set_xlabel(<span class="string">'Times  (minutes)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_dia.set_ylabel(<span class="string">'Hail Diameter  (cm)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_dlt.set_ylabel(<span class="string">'R_Hail Diameter  (cm.$\mathregular&#123;min^&#123;-1&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_cloud.set_ylabel(<span class="string">'CWC  (g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        qr_labelorder=int(math.floor(math.log10(np.array(qr[<span class="number">0</span>:ntt, ss]).max())))</span><br><span class="line">        print(<span class="string">"qr_labelorder"</span>,qr_labelorder)</span><br><span class="line"><span class="comment">#        ax_rain.set_ylabel('RWC     ($\mathregular&#123;10^&#123;'+str(qr_labelorder)+'&#125;&#125;$ g/kg)', fontsize=18)</span></span><br><span class="line">        ax_rain.set_ylabel(<span class="string">'RWC  ($\mathregular&#123;10^&#123;-1&#125;&#125;$ g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        <span class="comment">## 应对等于0情况</span></span><br><span class="line">        vc_labelorder = <span class="number">-3</span></span><br><span class="line">        <span class="keyword">if</span> (np.array(xpc2h[<span class="number">0</span>:ntt,ss]).max() &gt; <span class="number">0.0</span>):</span><br><span class="line">            vc_labelorder=int(math.floor(math.log10(np.array(xpc2h[<span class="number">0</span>:ntt, ss]).max())))</span><br><span class="line">        print(<span class="string">"vc_labelorder"</span>,vc_labelorder)</span><br><span class="line">        ax_vcloud.set_ylabel(<span class="string">'R_CWC  ($\mathregular&#123;10^&#123;'</span>+str(vc_labelorder)+<span class="string">'&#125;&#125;$ g.$\mathregular&#123;s^&#123;-1&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        <span class="comment">## 应对等于0情况</span></span><br><span class="line">        vr_labelorder = <span class="number">-6</span></span><br><span class="line">        <span class="keyword">if</span> (np.array(xpr2h[<span class="number">0</span>:ntt,ss]).max() &gt; <span class="number">0.0</span>):</span><br><span class="line">            vr_labelorder=int(math.floor(math.log10(np.array(xpr2h[<span class="number">0</span>:ntt, ss]).max())))</span><br><span class="line">        print(<span class="string">"vr_labelorder"</span>,vr_labelorder)</span><br><span class="line">        ax_vrain.set_ylabel(<span class="string">'R_RWC  ($\mathregular&#123;10^&#123;'</span>+str(vr_labelorder)+<span class="string">'&#125;&#125;$ g.$\mathregular&#123;s^&#123;-1&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_wwind.set_ylabel(<span class="string">'W  (m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">        ax_tem.set_ylabel(<span class="string">'Temperature  ($^\circ$C)'</span>, fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">        curve_hei, = ax_hei.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                 third_2000[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                 label=<span class="string">"Height"</span>,</span><br><span class="line">                                 color=<span class="string">'black'</span>,</span><br><span class="line">                                 lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_dia, = ax_dia.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">0</span>+tt0_1*<span class="number">50</span>/<span class="number">60</span>,</span><br><span class="line">                                 np.linspace(<span class="number">0</span>,<span class="number">4</span>, ntt),</span><br><span class="line">                                 label=<span class="string">"Hail Diameter=0.1"</span>,</span><br><span class="line">                                 color=<span class="string">'#FF7F24'</span>,</span><br><span class="line">                                 linestyle=<span class="string">'--'</span>,</span><br><span class="line">                                 lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_dia, = ax_dia.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                 d[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                 label=<span class="string">"Hail Diameter"</span>,</span><br><span class="line">                                 color=<span class="string">'#FF7F24'</span>,</span><br><span class="line">                                 lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_dlt, = ax_dlt.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                 dlt[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                 label=<span class="string">"R_Hail Diameter"</span>,</span><br><span class="line">                                 color=<span class="string">'red'</span>,</span><br><span class="line">                                 lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_cloud, = ax_cloud.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     qc[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                     label=<span class="string">"CWC"</span>,</span><br><span class="line">                                     color=<span class="string">'palegreen'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_rain, = ax_rain.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                   <span class="number">10</span>**(<span class="number">-1</span>*qr_labelorder)*qr[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                   label=<span class="string">"RWC"</span>,</span><br><span class="line">                                   color=<span class="string">'lightskyblue'</span>,</span><br><span class="line">                                   lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_vcloud, = ax_vcloud.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                       <span class="number">10</span>**(<span class="number">-1</span>*vc_labelorder)*xpc2h[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                       label=<span class="string">"R_CWC"</span>,</span><br><span class="line">                                       color=<span class="string">'green'</span>,</span><br><span class="line">                                       lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_vrain, = ax_vrain.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     <span class="number">10</span>**(<span class="number">-1</span>*vr_labelorder)*xpr2h[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                     label=<span class="string">"R_RWC"</span>,</span><br><span class="line">                                     color=<span class="string">'darkblue'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_wwind, = ax_wwind.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">0</span>,</span><br><span class="line">                                     label=<span class="string">"W=0"</span>,</span><br><span class="line">                                     color=<span class="string">'#CD1076'</span>,</span><br><span class="line">                                     linestyle=<span class="string">'--'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_wwind, = ax_wwind.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     xw[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                     label=<span class="string">"W"</span>,</span><br><span class="line">                                     color=<span class="string">'#CD1076'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_tem, = ax_tem.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     xt[<span class="number">0</span>:ntt, ss]*<span class="number">0</span>,</span><br><span class="line">                                     label=<span class="string">"Temperature=0"</span>,</span><br><span class="line">                                     color=<span class="string">'#8e7618'</span>,</span><br><span class="line">                                     linestyle=<span class="string">'--'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">        curve_tem, = ax_tem.plot(np.linspace(<span class="number">1</span>, ntt, ntt) * <span class="number">50</span> / <span class="number">60</span>,</span><br><span class="line">                                     xt[<span class="number">0</span>:ntt, ss],</span><br><span class="line">                                     label=<span class="string">"Temperature"</span>,</span><br><span class="line">                                     color=<span class="string">'#8e7618'</span>,</span><br><span class="line">                                     lw=<span class="number">2.0</span>)</span><br><span class="line">    </span><br><span class="line">        n1 = os.system(<span class="string">'head -100 ./para-time.py | grep "Trajectory-0.5-1.txt"'</span>)</span><br><span class="line">        n2 = os.system(<span class="string">'head -100 ./para-time.py | grep "Trajectory-1-1.5.txt"'</span>)</span><br><span class="line">        n3 = os.system(<span class="string">'head -100 ./para-time.py | grep "Trajectory-1.5-2.txt"'</span>)</span><br><span class="line">        n4 = os.system(<span class="string">'head -100 ./para-time.py | grep "Trajectory-2-2.5.txt"'</span>)</span><br><span class="line">        n5 = os.system(<span class="string">'head -100 ./para-time.py | grep "Trajectory-2.5.txt"'</span>)</span><br><span class="line">        print(<span class="string">"n1="</span>, n1)</span><br><span class="line">        print(<span class="string">"n2="</span>, n2)</span><br><span class="line">        print(<span class="string">"n3="</span>, n3)</span><br><span class="line">        print(<span class="string">"n4="</span>, n4)</span><br><span class="line">        print(<span class="string">"n5="</span>, n5)</span><br><span class="line">        <span class="comment"># 坐标轴范围</span></span><br><span class="line">        <span class="keyword">if</span> (n1 == <span class="number">0</span>):</span><br><span class="line">            ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">            ax_hei.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_dia.set_ylim(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">            ax_dia.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">            ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">1.0</span>, <span class="number">3</span>)</span><br><span class="line">            ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_rain.set_ylim(<span class="number">0</span>, <span class="number">0.8</span>)</span><br><span class="line">            ax_vcloud.set_ylim(<span class="number">0</span>, <span class="number">0.01</span>)</span><br><span class="line">            ax_vcloud.set_yticks([<span class="number">0</span>, <span class="number">0.002</span>, <span class="number">0.004</span>, <span class="number">0.006</span>, <span class="number">0.008</span>, <span class="number">0.010</span>])</span><br><span class="line">            ax_vrain.set_ylim(<span class="number">0</span>, <span class="number">0.0003</span>)</span><br><span class="line">            ax_vrain.set_yticks([<span class="number">0</span>, <span class="number">0.0001</span>, <span class="number">0.0002</span>, <span class="number">0.0003</span>])</span><br><span class="line">            ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">20</span>)</span><br><span class="line">            ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="keyword">if</span> (n2 == <span class="number">0</span>):</span><br><span class="line">            ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">            ax_hei.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_dia.set_ylim(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">            ax_dia.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>])</span><br><span class="line">            ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">            ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line">            ax_rain.set_ylim(<span class="number">0</span>, <span class="number">0.8</span>)</span><br><span class="line">            ax_vcloud.set_ylim(<span class="number">0</span>, <span class="number">0.01</span>)</span><br><span class="line">            ax_vcloud.set_yticks([<span class="number">0</span>, <span class="number">0.002</span>, <span class="number">0.004</span>, <span class="number">0.006</span>, <span class="number">0.008</span>, <span class="number">0.010</span>])</span><br><span class="line">            ax_vrain.set_ylim(<span class="number">0</span>, <span class="number">0.00050</span>)</span><br><span class="line">            ax_vrain.set_yticks([<span class="number">0</span>, <span class="number">0.0001</span>, <span class="number">0.0002</span>, <span class="number">0.0003</span>, <span class="number">0.0004</span>, <span class="number">0.0005</span>])</span><br><span class="line">            ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">20</span>)</span><br><span class="line">            ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="keyword">if</span> (n3 == <span class="number">0</span>):</span><br><span class="line">            ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">            ax_hei.set_ylim(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">            ax_dia.set_ylim(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">            ax_dia.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">            ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">            ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_rain.set_ylim(<span class="number">0</span>, <span class="number">0.5</span>)</span><br><span class="line">            ax_vcloud.set_ylim(<span class="number">0</span>, <span class="number">0.02</span>)</span><br><span class="line">            ax_vcloud.set_yticks([<span class="number">0</span>, <span class="number">0.005</span>, <span class="number">0.010</span>, <span class="number">0.015</span>, <span class="number">0.020</span>])</span><br><span class="line">            ax_vrain.set_ylim(<span class="number">0</span>, <span class="number">0.00080</span>)</span><br><span class="line">            ax_vrain.set_yticks([<span class="number">0</span>, <span class="number">0.0002</span>, <span class="number">0.0004</span>, <span class="number">0.0006</span>, <span class="number">0.0008</span>])</span><br><span class="line">            ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">30</span>)</span><br><span class="line">            ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="keyword">if</span> (n4 == <span class="number">0</span>):</span><br><span class="line">            ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">            ax_hei.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_dia.set_ylim(<span class="number">0</span>, <span class="number">3</span>)</span><br><span class="line">            ax_dia.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>])</span><br><span class="line">            ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">1.5</span>, <span class="number">3</span>)</span><br><span class="line">            ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">6</span>)</span><br><span class="line">            ax_rain.set_ylim(<span class="number">0</span>, <span class="number">0.8</span>)</span><br><span class="line">            ax_vcloud.set_ylim(<span class="number">0</span>, <span class="number">0.03</span>)</span><br><span class="line">            ax_vcloud.set_yticks([<span class="number">0</span>, <span class="number">0.005</span>, <span class="number">0.010</span>, <span class="number">0.015</span>, <span class="number">0.020</span>, <span class="number">0.025</span>, <span class="number">0.030</span>])</span><br><span class="line">            ax_vrain.set_ylim(<span class="number">0</span>, <span class="number">0.00080</span>)</span><br><span class="line">            ax_vrain.set_yticks([<span class="number">0</span>, <span class="number">0.0002</span>, <span class="number">0.0004</span>, <span class="number">0.0006</span>, <span class="number">0.0008</span>])</span><br><span class="line">            ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">30</span>)</span><br><span class="line">            ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line">        <span class="keyword">if</span> (n5 == <span class="number">0</span>):</span><br><span class="line">            ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">            ax_hei.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_dia.set_ylim(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">            ax_dia.set_yticks([<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>])</span><br><span class="line">            ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">2</span>, <span class="number">3</span>)</span><br><span class="line">            ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">            ax_rain.set_ylim(<span class="number">0</span>, <span class="number">0.6</span>)</span><br><span class="line">            ax_vcloud.set_ylim(<span class="number">0</span>, <span class="number">0.05</span>)</span><br><span class="line">            ax_vcloud.set_yticks([<span class="number">0</span>, <span class="number">0.010</span>, <span class="number">0.020</span>, <span class="number">0.030</span>, <span class="number">0.040</span>, <span class="number">0.050</span>])</span><br><span class="line">            ax_vrain.set_ylim(<span class="number">0</span>, <span class="number">0.0012</span>)</span><br><span class="line">            ax_vrain.set_yticks(</span><br><span class="line">                [<span class="number">0</span>, <span class="number">0.0002</span>, <span class="number">0.0004</span>, <span class="number">0.0006</span>, <span class="number">0.0008</span>, <span class="number">0.0010</span>, <span class="number">0.0012</span>])</span><br><span class="line">            ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">30</span>)</span><br><span class="line">            ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 坐标轴标签范围</span></span><br><span class="line">        maxhei = np.array(third_2000[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxHei"</span>,maxhei)</span><br><span class="line">        maxhei = int(math.ceil(maxhei/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxHei"</span>,maxhei)</span><br><span class="line">        maxdia = np.array(d[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxDia"</span>,maxdia)</span><br><span class="line">        maxdia = int(math.ceil(maxdia/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxDia"</span>,maxdia)</span><br><span class="line">        ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line">        maxdlt = np.array(dlt[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxdlt"</span>,maxdlt)</span><br><span class="line">        maxdlt = int(math.ceil(maxdlt/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxdlt"</span>,maxdlt)</span><br><span class="line">        maxqc = np.array(qc[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxqc"</span>,maxqc)</span><br><span class="line">        maxqc = int(math.ceil(maxqc/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxqc"</span>,maxqc)</span><br><span class="line">        maxqr = <span class="number">10</span>**(<span class="number">-1</span>*qr_labelorder)*np.array(qr[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxqr"</span>,maxqr)</span><br><span class="line">        maxqr = int(math.ceil(maxqr/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxqr"</span>,maxqr)</span><br><span class="line">        maxxpc2h = <span class="number">10</span>**(<span class="number">-1</span>*vc_labelorder)*np.array(xpc2h[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxxpc2h"</span>,maxxpc2h)</span><br><span class="line">        maxxpc2h = int(math.ceil(maxxpc2h/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxxpc2h"</span>,maxxpc2h)</span><br><span class="line">        maxxpr2h = <span class="number">10</span>**(<span class="number">-1</span>*vr_labelorder)*np.array(xpr2h[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxxpr2h"</span>,maxxpr2h)</span><br><span class="line">        maxxpr2h = int(math.ceil(maxxpr2h/<span class="number">2</span>)*<span class="number">2</span>)</span><br><span class="line">        print(<span class="string">"maxxpr2h"</span>,maxxpr2h)</span><br><span class="line">        maxxw = np.array(xw[<span class="number">0</span>:ntt, ss]).max()</span><br><span class="line">        print(<span class="string">"maxxw"</span>,maxxw)</span><br><span class="line">        maxxw = int(math.ceil(maxxw/<span class="number">10</span>)*<span class="number">10</span>)</span><br><span class="line">        print(<span class="string">"maxxw"</span>,maxxw)</span><br><span class="line">        ax_hei.set_xlim(<span class="number">0</span>, itt)</span><br><span class="line"><span class="comment">#        ax_hei.set_ylim(0, maxhei)</span></span><br><span class="line"><span class="comment">#        ax_hei.set_yticks(np.arange(0,maxhei+0.1,2))</span></span><br><span class="line">        ax_hei.set_ylim(<span class="number">0</span>, <span class="number">10</span>)</span><br><span class="line">        ax_hei.set_yticks(np.arange(<span class="number">0</span>,<span class="number">10</span>+<span class="number">0.1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="comment">#        ax_dia.set_ylim(0, maxdia)</span></span><br><span class="line"><span class="comment">#        ax_dia.set_yticks(np.arange(0,maxdia+0.1,1))</span></span><br><span class="line">        ax_dia.set_ylim(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line">        ax_dia.set_yticks(np.arange(<span class="number">0</span>,<span class="number">4</span>+<span class="number">0.1</span>,<span class="number">1</span>))</span><br><span class="line"><span class="comment">#        ax_dlt.set_ylim(0, maxdlt)</span></span><br><span class="line"><span class="comment">#        ax_dlt.set_yticks(np.arange(0,maxdlt+0.1,1))</span></span><br><span class="line">        ax_dlt.set_ylim(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line">        ax_dlt.set_yticks(np.arange(<span class="number">0</span>,<span class="number">2</span>+<span class="number">0.1</span>,<span class="number">1</span>))</span><br><span class="line"><span class="comment">#        ax_cloud.set_ylim(0, maxqc)</span></span><br><span class="line"><span class="comment">#        arr = 1</span></span><br><span class="line"><span class="comment">#        if (maxqc&gt;=4):</span></span><br><span class="line"><span class="comment">#            arr = 2</span></span><br><span class="line"><span class="comment">#        ax_cloud.set_yticks(np.arange(0,maxqc+0.1,arr))</span></span><br><span class="line">        ax_cloud.set_ylim(<span class="number">0</span>, <span class="number">8</span>)</span><br><span class="line">        ax_cloud.set_yticks(np.arange(<span class="number">0</span>,<span class="number">8</span>+<span class="number">0.1</span>,<span class="number">2</span>))</span><br><span class="line"><span class="comment">#        arr = 1</span></span><br><span class="line"><span class="comment">#        if (maxqr&gt;=4):</span></span><br><span class="line"><span class="comment">#            arr = 2</span></span><br><span class="line"><span class="comment">#        ax_rain.set_ylim(0, maxqr)</span></span><br><span class="line"><span class="comment">#        ax_rain.set_yticks(np.arange(0,maxqr+0.1,arr))</span></span><br><span class="line">        ax_rain.set_ylim(<span class="number">0</span>, <span class="number">12</span>)</span><br><span class="line">        ax_rain.set_yticks(np.arange(<span class="number">0</span>,<span class="number">12</span>+<span class="number">0.1</span>,<span class="number">4</span>))</span><br><span class="line">        arr = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (maxxpc2h&gt;=<span class="number">4</span>):</span><br><span class="line">            arr = <span class="number">2</span></span><br><span class="line">        ax_vcloud.set_ylim(<span class="number">0</span>, maxxpc2h)</span><br><span class="line">        ax_vcloud.set_yticks(np.arange(<span class="number">0</span>,maxxpc2h+<span class="number">0.1</span>,arr))</span><br><span class="line">        <span class="keyword">if</span> (maxxpc2h==<span class="number">0</span>):</span><br><span class="line">            ax_vcloud.set_yticks(np.arange(<span class="number">0</span>,<span class="number">2.1</span>,<span class="number">1</span>))</span><br><span class="line">        arr = <span class="number">1</span></span><br><span class="line">        <span class="keyword">if</span> (maxxpr2h&gt;=<span class="number">4</span>):</span><br><span class="line">            arr = <span class="number">2</span></span><br><span class="line">        ax_vrain.set_ylim(<span class="number">0</span>, maxxpr2h)</span><br><span class="line">        ax_vrain.set_yticks(np.arange(<span class="number">0</span>,maxxpr2h+<span class="number">0.1</span>,arr))</span><br><span class="line">        <span class="keyword">if</span> (maxxpr2h==<span class="number">0</span>):</span><br><span class="line">            ax_vrain.set_yticks(np.arange(<span class="number">0</span>,<span class="number">2.1</span>,<span class="number">1</span>))</span><br><span class="line"><span class="comment">#        ax_wwind.set_ylim(-10, maxxw)</span></span><br><span class="line"><span class="comment">#        ax_wwind.set_yticks(np.arange(-10,maxxw+0.1,10))</span></span><br><span class="line">        ax_wwind.set_ylim(<span class="number">-10</span>, <span class="number">30</span>)</span><br><span class="line">        ax_wwind.set_yticks(np.arange(<span class="number">-10</span>,<span class="number">30</span>+<span class="number">0.1</span>,<span class="number">10</span>))</span><br><span class="line">        ax_tem.set_ylim(<span class="number">-50</span>, <span class="number">20</span>)</span><br><span class="line">        ax_tem.set_yticks(np.arange(<span class="number">-50</span>,<span class="number">20</span>+<span class="number">0.1</span>,<span class="number">10</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment"># 坐标轴标签</span></span><br><span class="line">        ax_hei.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line">        ax_hei.yaxis.label.set_color(curve_hei.get_color())</span><br><span class="line">        ax_dia.yaxis.label.set_color(curve_dia.get_color())</span><br><span class="line">        ax_dlt.yaxis.label.set_color(curve_dlt.get_color())</span><br><span class="line">        ax_cloud.yaxis.label.set_color(curve_cloud.get_color())</span><br><span class="line">        ax_rain.yaxis.label.set_color(curve_rain.get_color())</span><br><span class="line">        ax_vcloud.yaxis.label.set_color(curve_vcloud.get_color())</span><br><span class="line">        ax_vrain.yaxis.label.set_color(curve_vrain.get_color())</span><br><span class="line">        ax_wwind.yaxis.label.set_color(curve_wwind.get_color())</span><br><span class="line">        ax_tem.yaxis.label.set_color(curve_tem.get_color())</span><br><span class="line">    </span><br><span class="line">        <span class="comment"># 边框</span></span><br><span class="line">        bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">        ax_hei.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">        <span class="comment">#ax_hei.spines['top'].set_linewidth(bwith)</span></span><br><span class="line">        <span class="comment">#ax_hei.spines['right'].set_linewidth(bwith)</span></span><br><span class="line">        ax_hei.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_dia.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_dia.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_dlt.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_cloud.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_rain.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_vcloud.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_vrain.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_wwind.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">        ax_tem.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">    </span><br><span class="line">        ax_dia.spines[<span class="string">'left'</span>].set_color(<span class="string">"#FF7F24"</span>)</span><br><span class="line">        ax_dia.spines[<span class="string">'right'</span>].set_color(<span class="string">'#FF7F24'</span>)</span><br><span class="line">        ax_dlt.spines[<span class="string">'right'</span>].set_color(<span class="string">'red'</span>)</span><br><span class="line">        ax_cloud.spines[<span class="string">'right'</span>].set_color(<span class="string">'palegreen'</span>)</span><br><span class="line">        ax_rain.spines[<span class="string">'right'</span>].set_color(<span class="string">'lightskyblue'</span>)</span><br><span class="line">        ax_vcloud.spines[<span class="string">'right'</span>].set_color(<span class="string">'green'</span>)</span><br><span class="line">        ax_vrain.spines[<span class="string">'right'</span>].set_color(<span class="string">'darkblue'</span>)</span><br><span class="line">        ax_wwind.spines[<span class="string">'right'</span>].set_color(<span class="string">'#CD1076'</span>)</span><br><span class="line">        ax_tem.spines[<span class="string">'right'</span>].set_color(<span class="string">'#8e7618'</span>)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 刻度长度和颜色 刻度标签字体大小</span></span><br><span class="line">        tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">15</span>)</span><br><span class="line">        ax_hei.tick_params(axis=<span class="string">'x'</span>, **tkw)</span><br><span class="line">        ax_hei.tick_params(axis=<span class="string">'y'</span>, colors=curve_hei.get_color(), **tkw)</span><br><span class="line">        ax_dia.tick_params(axis=<span class="string">'y'</span>, colors=curve_dia.get_color(), **tkw)</span><br><span class="line">        ax_dlt.tick_params(axis=<span class="string">'y'</span>, colors=curve_dlt.get_color(), **tkw)</span><br><span class="line">        ax_cloud.tick_params(axis=<span class="string">'y'</span>, colors=curve_cloud.get_color(), **tkw)</span><br><span class="line">        ax_rain.tick_params(axis=<span class="string">'y'</span>, colors=curve_rain.get_color(), **tkw)</span><br><span class="line">        ax_vcloud.tick_params(axis=<span class="string">'y'</span>, colors=curve_vcloud.get_color(), **tkw)</span><br><span class="line">        ax_vrain.tick_params(axis=<span class="string">'y'</span>, colors=curve_vrain.get_color(), **tkw)</span><br><span class="line">        ax_wwind.tick_params(axis=<span class="string">'y'</span>, colors=curve_wwind.get_color(), **tkw)</span><br><span class="line">        ax_tem.tick_params(axis=<span class="string">'y'</span>, colors=curve_tem.get_color(), **tkw)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 设置刻度标签和坐标轴之间距离</span></span><br><span class="line">        <span class="keyword">for</span> tick <span class="keyword">in</span> ax_hei.xaxis.get_major_ticks()[:]:</span><br><span class="line">            tick.set_pad(<span class="number">12</span>)</span><br><span class="line">        <span class="keyword">for</span> tick <span class="keyword">in</span> ax_hei.yaxis.get_major_ticks()[:]:</span><br><span class="line">            tick.set_pad(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">        lines = [</span><br><span class="line">            curve_hei, curve_wwind,curve_dia, curve_dlt, curve_cloud, curve_rain, curve_vcloud,</span><br><span class="line">            curve_vrain, curve_tem</span><br><span class="line">        ]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 设置图片标签</span></span><br><span class="line">        ax_hei.legend(lines, [l.get_label() <span class="keyword">for</span> l <span class="keyword">in</span> lines],</span><br><span class="line">                      loc=<span class="string">'upper center'</span>,</span><br><span class="line">                      fontsize=<span class="number">15</span>,</span><br><span class="line">                      frameon=<span class="literal">True</span>,</span><br><span class="line">                      fancybox=<span class="literal">True</span>,</span><br><span class="line">                      framealpha=<span class="number">0.8</span>,</span><br><span class="line">                      borderpad=<span class="number">0.3</span>,</span><br><span class="line">                      labelspacing=<span class="number">1.0</span>,</span><br><span class="line">                      ncol=<span class="number">5</span>,</span><br><span class="line">                      markerfirst=<span class="literal">False</span>,</span><br><span class="line">                      markerscale=<span class="number">1</span>,</span><br><span class="line">                      numpoints=<span class="number">1</span>,</span><br><span class="line">                      bbox_to_anchor=(<span class="number">1.10</span>, <span class="number">1.47</span>),</span><br><span class="line">                      handlelength=<span class="number">3.5</span>)</span><br><span class="line"></span><br><span class="line">        plt.savefig(<span class="string">'./para-time-K='</span>+str(k)+<span class="string">'_'</span>+str(pp)+<span class="string">'.png'</span>)</span><br><span class="line">        plt.close()</span><br></pre></td></tr></table></figure>
<h3 id="冰雹轨迹投影绘图"><a href="#冰雹轨迹投影绘图" class="headerlink" title="冰雹轨迹投影绘图"></a>冰雹轨迹投影绘图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E6%8A%95%E5%BD%B1%E7%BB%98%E5%9B%BE/kmeans-latitude-K=1-1-%E4%BE%8B%E5%9B%BE.png" class>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.pyplot <span class="keyword">import</span> MultipleLocator</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> interp1d</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> mpatches</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> interpolate</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 正规化数据集 X</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">normalize</span><span class="params">(X, axis=<span class="number">-1</span>, p=<span class="number">2</span>)</span>:</span></span><br><span class="line">    lp_norm = np.atleast_1d(np.linalg.norm(X, p, axis))</span><br><span class="line">    lp_norm[lp_norm == <span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> X / np.expand_dims(lp_norm, axis)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 计算一个样本与数据集中所有样本的欧氏距离的平方</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">euclidean_distance</span><span class="params">(one_sample, X)</span>:</span></span><br><span class="line">    one_sample = one_sample.reshape(<span class="number">1</span>, <span class="number">-1</span>)</span><br><span class="line">    X = X.reshape(X.shape[<span class="number">0</span>], <span class="number">-1</span>)</span><br><span class="line">    distances = np.power(np.tile(one_sample, (X.shape[<span class="number">0</span>], <span class="number">1</span>)) - X,</span><br><span class="line">                         <span class="number">2</span>).sum(axis=<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">return</span> distances</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Kmeans</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="string">"""Kmeans聚类算法.</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">    Parameters:</span></span><br><span class="line"><span class="string">    -----------</span></span><br><span class="line"><span class="string">    k: int</span></span><br><span class="line"><span class="string">        聚类的数目.</span></span><br><span class="line"><span class="string">    max_iterations: int</span></span><br><span class="line"><span class="string">        最大迭代次数. </span></span><br><span class="line"><span class="string">    varepsilon: float</span></span><br><span class="line"><span class="string">        判断是否收敛, 如果上一次的所有k个聚类中心与本次的所有k个聚类中心的差都小于varepsilon, </span></span><br><span class="line"><span class="string">        则说明算法已经收敛</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, k=<span class="number">2</span>, max_iterations=<span class="number">500</span>, varepsilon=<span class="number">0.0001</span>)</span>:</span></span><br><span class="line">        self.k = k</span><br><span class="line">        self.max_iterations = max_iterations</span><br><span class="line">        self.varepsilon = varepsilon</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 从所有样本中随机选取self.k样本作为初始的聚类中心</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">init_random_centroids</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        n_samples, n_features = np.shape(X)</span><br><span class="line">        centroids = np.zeros((self.k, n_features))</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(self.k):</span><br><span class="line">            centroid = X[np.random.choice(range(n_samples))]</span><br><span class="line">            centroids[i] = centroid</span><br><span class="line">        <span class="keyword">return</span> centroids</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 返回距离该样本最近的一个中心索引[0, self.k)</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_closest_centroid</span><span class="params">(self, sample, centroids)</span>:</span></span><br><span class="line">        distances = euclidean_distance(sample, centroids)</span><br><span class="line">        closest_i = np.argmin(distances)</span><br><span class="line">        <span class="keyword">return</span> closest_i</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将所有样本进行归类，归类规则就是将该样本归类到与其最近的中心</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">create_clusters</span><span class="params">(self, centroids, X)</span>:</span></span><br><span class="line">        n_samples = np.shape(X)[<span class="number">0</span>]</span><br><span class="line">        clusters = [[] <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.k)]</span><br><span class="line">        <span class="keyword">for</span> sample_i, sample <span class="keyword">in</span> enumerate(X):</span><br><span class="line">            centroid_i = self._closest_centroid(sample, centroids)</span><br><span class="line">            clusters[centroid_i].append(sample_i)</span><br><span class="line">        <span class="keyword">return</span> clusters</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对中心进行更新</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">update_centroids</span><span class="params">(self, clusters, X)</span>:</span></span><br><span class="line">        n_features = np.shape(X)[<span class="number">1</span>]</span><br><span class="line">        centroids = np.zeros((self.k, n_features))</span><br><span class="line">        <span class="keyword">for</span> i, cluster <span class="keyword">in</span> enumerate(clusters):</span><br><span class="line">            centroid = np.mean(X[cluster], axis=<span class="number">0</span>)</span><br><span class="line">            centroids[i] = centroid</span><br><span class="line">        <span class="keyword">return</span> centroids</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 将所有样本进行归类，其所在的类别的索引就是其类别标签</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get_cluster_labels</span><span class="params">(self, clusters, X)</span>:</span></span><br><span class="line">        y_pred = np.zeros(np.shape(X)[<span class="number">0</span>])</span><br><span class="line">        <span class="keyword">for</span> cluster_i, cluster <span class="keyword">in</span> enumerate(clusters):</span><br><span class="line">            <span class="keyword">for</span> sample_i <span class="keyword">in</span> cluster:</span><br><span class="line">                y_pred[sample_i] = cluster_i</span><br><span class="line">        <span class="keyword">return</span> y_pred</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 对整个数据集X进行Kmeans聚类，返回其聚类的标签</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">predict</span><span class="params">(self, X)</span>:</span></span><br><span class="line">        <span class="comment"># 从所有样本中随机选取self.k样本作为初始的聚类中心</span></span><br><span class="line">        centroids = self.init_random_centroids(X)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># 迭代，直到算法收敛(上一次的聚类中心和这一次的聚类中心几乎重合)或者达到最大迭代次数</span></span><br><span class="line">        <span class="keyword">for</span> _ <span class="keyword">in</span> range(self.max_iterations):</span><br><span class="line">            <span class="comment"># 将所有进行归类，归类规则就是将该样本归类到与其最近的中心</span></span><br><span class="line">            clusters = self.create_clusters(centroids, X)</span><br><span class="line">            former_centroids = centroids</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 计算新的聚类中心</span></span><br><span class="line">            centroids = self.update_centroids(clusters, X)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果聚类中心几乎没有变化，说明算法已经收敛，退出迭代</span></span><br><span class="line">            diff = centroids - former_centroids</span><br><span class="line">            <span class="keyword">if</span> diff.any() &lt; self.varepsilon:</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> self.get_cluster_labels(clusters, X)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># define variable</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">uvw = np.loadtxt(<span class="string">"./data/UVW-0.5.txt"</span>)</span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line">print(<span class="string">"nn="</span>, nn)</span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line">print(<span class="string">"nt="</span>, nt)</span><br><span class="line">first = np.empty([nt, nn], dtype=float)</span><br><span class="line">second = np.empty([nt, nn], dtype=float)</span><br><span class="line">third = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">uu = np.empty([nt, nn], dtype=float)</span><br><span class="line">vv = np.empty([nt, nn], dtype=float)</span><br><span class="line">ww = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">first[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">uu[:, <span class="number">0</span>:nn] = np.transpose(uvw[<span class="number">0</span>:nn, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">vv[:, <span class="number">0</span>:nn] = np.transpose(uvw[<span class="number">0</span>:nn, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">ww[:, <span class="number">0</span>:nn] = np.transpose(uvw[<span class="number">0</span>:nn, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">traj = np.zeros((nn, nt, <span class="number">3</span>))</span><br><span class="line">traj[:, :, <span class="number">0</span>] = np.transpose(first)</span><br><span class="line">traj[:, :, <span class="number">1</span>] = np.transpose(second)</span><br><span class="line">traj[:, :, <span class="number">2</span>] = np.transpose(third)</span><br><span class="line">X = traj[:, :, :]</span><br><span class="line">XX = X.reshape((nn, nt * <span class="number">3</span>))</span><br><span class="line"><span class="comment">#print(X)</span></span><br><span class="line"><span class="comment">#print("间隔")</span></span><br><span class="line"><span class="comment">#print(XX)</span></span><br><span class="line"><span class="comment">#print("test")</span></span><br><span class="line"><span class="comment">#print(X[1, 0, 0])</span></span><br><span class="line"><span class="comment">#print(XX[nt, 0])</span></span><br><span class="line"><span class="comment">#print("test")</span></span><br><span class="line"></span><br><span class="line">SSE = []</span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">11</span>):</span><br><span class="line">    km = KMeans(n_clusters=i)</span><br><span class="line">    km.fit(XX)</span><br><span class="line">    SSE.append(km.inertia_)</span><br><span class="line">print(<span class="string">"SSE="</span>, SSE)</span><br><span class="line">print(<span class="string">"SSE0="</span>, SSE[<span class="number">0</span>])</span><br><span class="line"><span class="comment">#SSB = map(int, SSE)</span></span><br><span class="line"><span class="comment">### 斜率阈值</span></span><br><span class="line">SSB = SSE[:]</span><br><span class="line">SSB[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span>):</span><br><span class="line">    <span class="comment">#    print(k)</span></span><br><span class="line">    <span class="comment">#    print(SSE[k - 1] / SSE[k])</span></span><br><span class="line">    SSB[k] = (SSE[k - <span class="number">1</span>] * <span class="number">1.0</span> - SSE[k] * <span class="number">1.0</span>) / SSE[<span class="number">0</span>] * <span class="number">1.0</span></span><br><span class="line">print(<span class="string">"SSB="</span>, SSB)</span><br><span class="line">xx = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">plt.plot(xx, SSE)</span><br><span class="line"><span class="comment">#plt.savefig('./SSE.png', dpi=500)</span></span><br><span class="line"><span class="comment">#plt.show()</span></span><br><span class="line"><span class="comment">#plt.close()</span></span><br><span class="line"></span><br><span class="line">clf = Kmeans(k=<span class="number">5</span>)</span><br><span class="line">y_pred = clf.predict(XX)</span><br><span class="line">print(<span class="string">"y_pred"</span>, y_pred)</span><br><span class="line">print(<span class="string">"y_pred.shape"</span>, y_pred.shape)</span><br><span class="line"><span class="comment">#np.savetxt('y_pred.txt', (y_pred), delimiter=',', fmt="%d")</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># print hail's diameter</span></span><br><span class="line">print(len(d))</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment">#ax = fig.gca()</span></span><br><span class="line"><span class="comment"># draw the figure, the color is r = read</span></span><br><span class="line">dmax = np.array(d).max()</span><br><span class="line">dmin = np.array(d).min()</span><br><span class="line">print(dmin, dmax)</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            <span class="comment">#            print(first[j, i])</span></span><br><span class="line">            first[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，mi'</span></span><br><span class="line">xmax = np.array(first).max()</span><br><span class="line">xmin = np.array(first).min()</span><br><span class="line">print(<span class="string">'xmin='</span>, xmin, <span class="string">'  '</span>, <span class="string">'xmax='</span>, xmax)</span><br><span class="line">ymax = np.array(second).max()</span><br><span class="line">ymin = np.array(second).min()</span><br><span class="line">print(<span class="string">'ymin='</span>, ymin, <span class="string">'  '</span>, <span class="string">'ymax='</span>, ymax)</span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first = <span class="number">104.9827</span> + first * x_co</span><br><span class="line">second = <span class="number">35.22662</span> + second * y_co</span><br><span class="line"><span class="comment">#print(first)</span></span><br><span class="line"><span class="comment">#print(second)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># choose color for hail's diameter</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line">tt = <span class="number">0</span></span><br><span class="line">flag = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"><span class="comment">## add</span></span><br><span class="line"><span class="comment">#iw = np.where((second[nt - 1, :] &gt;= 36.0000) &amp; (second[nt - 1, :] &lt; 36.5000))</span></span><br><span class="line"><span class="comment">####iw = np.where(y_pred[:] == 1)</span></span><br><span class="line"><span class="comment">####print('iw=', iw[0])</span></span><br><span class="line"><span class="comment">####print('iw.shape=', iw[0].shape)</span></span><br><span class="line"><span class="comment">####print('y_pred.shape=', y_pred.shape)</span></span><br><span class="line"><span class="comment">####print('len=', len(iw[0]))</span></span><br><span class="line"><span class="comment">#print('iw[0]=', iw[0][0])</span></span><br><span class="line"><span class="comment">#print('iw[1]=', iw[0][1])</span></span><br><span class="line"><span class="comment">####maxd = max(max(d[nt - 1, iw]))</span></span><br><span class="line"><span class="comment">####iwd = np.where(d[nt - 1, :] == maxd)</span></span><br><span class="line"><span class="comment">####print("iwd=", iwd)</span></span><br><span class="line"><span class="comment">####print("iwd=", iwd[0])</span></span><br><span class="line"><span class="comment">#print(d[:, iw][:, 0, 0])</span></span><br><span class="line"><span class="comment">#print(d[:, iw][:, 0, 1])</span></span><br><span class="line"></span><br><span class="line"><span class="comment">####it = np.empty([len(iw[0])], dtype=int)</span></span><br><span class="line"><span class="comment">####for i in range(len(iw[0])):</span></span><br><span class="line"><span class="comment">####    #    print(i)</span></span><br><span class="line"><span class="comment">####    #    it[i] = min(min(np.where(d[:, iw][:, 0, iw[0][i]] &gt;= 0.3)))</span></span><br><span class="line"><span class="comment">####    it[i] = min(min(np.where(d[:, iw][:, 0, i] &gt;= 0.3)))</span></span><br><span class="line"><span class="comment">####    if (it[i] &lt;= 10):</span></span><br><span class="line"><span class="comment">####        it[i] = 10</span></span><br><span class="line"><span class="comment">####print('it=', it)</span></span><br><span class="line"><span class="comment">## add</span></span><br><span class="line">mm = <span class="number">-1</span></span><br><span class="line"><span class="comment">#for i in range(nn):</span></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">    <span class="comment"># new a figure and set it into 3d</span></span><br><span class="line">    fig = plt.figure()</span><br><span class="line">    ax = fig.gca()</span><br><span class="line">    print(<span class="string">"K="</span>, k)</span><br><span class="line">    iw = np.where(y_pred[:] == order[k])</span><br><span class="line"></span><br><span class="line">    <span class="comment">### 计算大于0.1cm的时刻</span></span><br><span class="line">    it = np.empty([len(iw[<span class="number">0</span>])], dtype=int)</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(iw[<span class="number">0</span>])):</span><br><span class="line">        <span class="comment">#        print("d[:,iw].shape=", d[:, iw].shape)</span></span><br><span class="line">        <span class="comment">#        print(np.where(d[:, iw][:, 0, i] &gt;= 0.1))</span></span><br><span class="line">        it[i] = min(min(np.where(d[:, iw][:, <span class="number">0</span>, i] &gt;= <span class="number">0.0</span>)))</span><br><span class="line"><span class="comment">#        if (it[i] &lt;= 10):</span></span><br><span class="line"><span class="comment">#            it[i] = 10</span></span><br><span class="line">    print(<span class="string">'it.shape='</span>, it.shape)</span><br><span class="line">    print(<span class="string">'iw.shape='</span>, iw[<span class="number">0</span>].shape)</span><br><span class="line">    <span class="comment">#    print('it=', it)</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diwmax = np.amax(d[nt<span class="number">-1</span>, iw], axis=<span class="number">0</span>)</span><br><span class="line">    print(diwmax)</span><br><span class="line">    print(<span class="string">"diwmax.shape"</span>, diwmax.shape)</span><br><span class="line">    iwiw11 = <span class="number">999999</span></span><br><span class="line">    iwiw22 = <span class="number">999999</span></span><br><span class="line">    iwiw33 = <span class="number">999999</span></span><br><span class="line">    iwiw44 = <span class="number">999999</span></span><br><span class="line">    iwiw55 = <span class="number">999999</span></span><br><span class="line">    i11 = <span class="number">999999</span></span><br><span class="line">    i22 = <span class="number">999999</span></span><br><span class="line">    i33 = <span class="number">999999</span></span><br><span class="line">    i44 = <span class="number">999999</span></span><br><span class="line">    i55 = <span class="number">999999</span></span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">0.5</span>):</span><br><span class="line">        iwiw1 = np.where((diwmax[:] &gt; <span class="number">0.5</span>) &amp; (diwmax[:] &lt;= <span class="number">1.0</span>))</span><br><span class="line">        iwiw11 = np.where(diwmax[:] == np.array(diwmax[iwiw1]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">1.0</span>):</span><br><span class="line">        iwiw2 = np.where((diwmax[:] &gt; <span class="number">1.0</span>) &amp; (diwmax[:] &lt;= <span class="number">1.5</span>))</span><br><span class="line">        iwiw22 = np.where(diwmax[:] == np.array(diwmax[iwiw2]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">1.5</span>):</span><br><span class="line">        iwiw3 = np.where((diwmax[:] &gt; <span class="number">1.5</span>) &amp; (diwmax[:] &lt;= <span class="number">2.0</span>))</span><br><span class="line">        iwiw33 = np.where(diwmax[:] == np.array(diwmax[iwiw3]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">2.0</span>):</span><br><span class="line">        iwiw4 = np.where((diwmax[:] &gt; <span class="number">2.0</span>) &amp; (diwmax[:] &lt;= <span class="number">2.5</span>))</span><br><span class="line">        iwiw44 = np.where(diwmax[:] == np.array(diwmax[iwiw4]).max())</span><br><span class="line">    <span class="keyword">if</span> (np.array(diwmax).max() &gt; <span class="number">2.5</span>):</span><br><span class="line">        iwiw5 = np.where((diwmax[:] &gt; <span class="number">2.5</span>))</span><br><span class="line">        iwiw55 = np.where(diwmax[:] == np.array(diwmax[iwiw5]).max())</span><br><span class="line">    <span class="keyword">if</span> (iwiw11 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw11"</span>, iwiw11[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"0.5-1.0cm最大直径"</span>, diwmax[iwiw11])</span><br><span class="line">        print(<span class="string">"0.5-1.0cm轨迹数"</span>, iwiw1[<span class="number">0</span>].shape)</span><br><span class="line">        <span class="comment">#print("iw", iw)</span></span><br><span class="line">        <span class="comment">#print("iw.shape", iw[0].shape)</span></span><br><span class="line">        i11 = iw[<span class="number">0</span>][iwiw11[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i11"</span>, i11)</span><br><span class="line">    <span class="keyword">if</span> (iwiw22 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw22"</span>, iwiw22[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"1.0-1.5cm最大直径"</span>, diwmax[iwiw22])</span><br><span class="line">        print(<span class="string">"1.0-1.5cm轨迹数"</span>, iwiw2[<span class="number">0</span>].shape)</span><br><span class="line">        i22 = iw[<span class="number">0</span>][iwiw22[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i22"</span>, i22)</span><br><span class="line">    <span class="keyword">if</span> (iwiw33 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw33"</span>, iwiw33[<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"1.5-2.0cm最大直径"</span>, diwmax[iwiw33])</span><br><span class="line">        print(<span class="string">"1.5-2.0cm轨迹数"</span>, iwiw3[<span class="number">0</span>].shape)</span><br><span class="line">        i33 = iw[<span class="number">0</span>][iwiw33[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i33"</span>, i33)</span><br><span class="line">    <span class="keyword">if</span> (iwiw44 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw44"</span>, iwiw44[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"2.0-2.5cm最大直径"</span>, diwmax[iwiw44])</span><br><span class="line">        print(<span class="string">"2.0-2.5cm轨迹数"</span>, iwiw4[<span class="number">0</span>].shape)</span><br><span class="line">        i44 = iw[<span class="number">0</span>][iwiw44[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i44"</span>, i44)</span><br><span class="line">    <span class="keyword">if</span> (iwiw55 != <span class="number">999999</span>):</span><br><span class="line">        print(<span class="string">"iwiw55"</span>, iwiw55[<span class="number">0</span>][<span class="number">0</span>])</span><br><span class="line">        print(<span class="string">"&gt;2.5cm最大直径"</span>, diwmax[iwiw55])</span><br><span class="line">        print(<span class="string">"&gt;2.5cm-轨迹数"</span>, iwiw5[<span class="number">0</span>].shape)</span><br><span class="line">        i55 = iw[<span class="number">0</span>][iwiw55[<span class="number">0</span>][<span class="number">0</span>]]</span><br><span class="line">        print(<span class="string">"i55"</span>, i55)</span><br><span class="line">    print(<span class="string">'iw='</span>, iw[<span class="number">0</span>])</span><br><span class="line">    print(<span class="string">'iw.shape='</span>, iw[<span class="number">0</span>].shape)</span><br><span class="line">    dmaxiw5 = [iwiw11, iwiw22, iwiw33, iwiw44, iwiw55]</span><br><span class="line">    <span class="comment">#    print('y_pred.shape=', y_pred.shape)</span></span><br><span class="line">    <span class="comment">#    print('len=', len(iw[0]))</span></span><br><span class="line">    minlat = <span class="number">999</span></span><br><span class="line">    maxlat = <span class="number">0</span></span><br><span class="line">    minlon = <span class="number">999</span></span><br><span class="line">    maxlon = <span class="number">0</span></span><br><span class="line">    maxhei = <span class="number">0</span></span><br><span class="line">    diw = [i11, i22, i33, i44, i55]</span><br><span class="line">    kdiw = <span class="number">0</span></span><br><span class="line"><span class="comment">#    for i in range(nn):</span></span><br><span class="line"><span class="comment">#        if ((i == i11) | (i == i22) | (i == i33) | (i == i44) | (i == i55)):</span></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">            i =diw[m]</span><br><span class="line">            <span class="keyword">if</span> np.array(i==<span class="number">999999</span>):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="keyword">if</span> (maxlon &lt; np.array(</span><br><span class="line">                    first[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())):</span><br><span class="line">                maxlon = np.array(</span><br><span class="line">                    first[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())</span><br><span class="line">            <span class="keyword">if</span> (minlon &gt; np.array(</span><br><span class="line">                    first[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].min())):</span><br><span class="line">                minlon = np.array(</span><br><span class="line">                    first[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].min())</span><br><span class="line">            <span class="keyword">if</span> (maxlat &lt; np.array(</span><br><span class="line">                    second[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())):</span><br><span class="line">                maxlat = np.array(</span><br><span class="line">                    second[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())</span><br><span class="line">            <span class="keyword">if</span> (minlat &gt; np.array(</span><br><span class="line">                    second[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].min())):</span><br><span class="line">                minlat = np.array(</span><br><span class="line">                    second[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].min())</span><br><span class="line">            <span class="keyword">if</span> (maxhei &lt; np.array(</span><br><span class="line">                    third[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())):</span><br><span class="line">                maxhei = np.array(</span><br><span class="line">                    third[it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])]:nt+<span class="number">1</span>, i].max())</span><br><span class="line">            print(<span class="string">"maxlon"</span>, maxlon)</span><br><span class="line">            print(<span class="string">"minlon"</span>, minlon)</span><br><span class="line">            print(<span class="string">"maxlat"</span>, maxlat)</span><br><span class="line">            print(<span class="string">"minlat"</span>, minlat)</span><br><span class="line">        </span><br><span class="line">            gyglat = <span class="number">0</span></span><br><span class="line">            <span class="keyword">if</span> np.any((maxlat-minlat)&lt;=<span class="number">0.051</span>):</span><br><span class="line">                gyglat = <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> np.any((maxlat-minlat)&gt;<span class="number">0.051</span>):</span><br><span class="line">                gyglat = <span class="number">0</span></span><br><span class="line">                maxlat = float(int(math.ceil(maxlat * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>)</span><br><span class="line">                minlat = float(int(math.floor(minlat * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>)</span><br><span class="line">            maxlon = float(int(math.ceil(maxlon * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>)</span><br><span class="line">            minlon = float(int(math.floor(minlon * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>)</span><br><span class="line">            maxhei = int(math.ceil(maxhei))</span><br><span class="line">            print(<span class="string">"maxlon"</span>, float(int(math.ceil(maxlon * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>))</span><br><span class="line">            print(<span class="string">"minlon"</span>, float(int(math.floor(minlon * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>))</span><br><span class="line">            print(<span class="string">"maxlat"</span>, float(math.ceil(maxlat * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>)</span><br><span class="line">            print(<span class="string">"minlat"</span>, float(int(math.floor(minlat * <span class="number">100</span> / <span class="number">5</span>) *<span class="number">5</span>)/<span class="number">100</span>))</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> m <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">            i =diw[m]</span><br><span class="line">            <span class="keyword">if</span> np.array(i==<span class="number">999999</span>):</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            fig = plt.figure()</span><br><span class="line">            ax = fig.gca()</span><br><span class="line"><span class="comment">#            minlat = 999</span></span><br><span class="line"><span class="comment">#            maxlat = 0</span></span><br><span class="line"><span class="comment">#            minlon = 999</span></span><br><span class="line"><span class="comment">#            maxlon = 0</span></span><br><span class="line"><span class="comment">#            maxhei = 0</span></span><br><span class="line"><span class="comment">#            if (maxlon &lt; np.array(</span></span><br><span class="line"><span class="comment">#                    first[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())):</span></span><br><span class="line"><span class="comment">#                maxlon = np.array(</span></span><br><span class="line"><span class="comment">#                    first[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())</span></span><br><span class="line"><span class="comment">#            if (minlon &gt; np.array(</span></span><br><span class="line"><span class="comment">#                    first[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].min())):</span></span><br><span class="line"><span class="comment">#                minlon = np.array(</span></span><br><span class="line"><span class="comment">#                    first[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].min())</span></span><br><span class="line"><span class="comment">#            if (maxlat &lt; np.array(</span></span><br><span class="line"><span class="comment">#                    second[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())):</span></span><br><span class="line"><span class="comment">#                maxlat = np.array(</span></span><br><span class="line"><span class="comment">#                    second[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())</span></span><br><span class="line"><span class="comment">#            if (minlat &gt; np.array(</span></span><br><span class="line"><span class="comment">#                    second[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].min())):</span></span><br><span class="line"><span class="comment">#                minlat = np.array(</span></span><br><span class="line"><span class="comment">#                    second[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].min())</span></span><br><span class="line"><span class="comment">#            if (maxhei &lt; np.array(</span></span><br><span class="line"><span class="comment">#                    third[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())):</span></span><br><span class="line"><span class="comment">#                maxhei = np.array(</span></span><br><span class="line"><span class="comment">#                    third[it[(np.where(iw[0][:] == i)[0][0])]:nt+1, i].max())</span></span><br><span class="line">            print(np.array(second[:, i].min()))</span><br><span class="line">            print(<span class="string">"Satisfyied I="</span>, i)</span><br><span class="line">            print(<span class="string">"Satisfyide J="</span>, it[np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>]])</span><br><span class="line">            <span class="keyword">for</span> j <span class="keyword">in</span> range(it[(np.where(iw[<span class="number">0</span>][:] == i)[<span class="number">0</span>][<span class="number">0</span>])], nt):</span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt;= <span class="number">0</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">0.3</span>):</span><br><span class="line">                    cc = <span class="string">'lightskyblue'</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt;= <span class="number">0.3</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">0.6</span>):</span><br><span class="line">                    cc = <span class="string">'blue'</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">0.6</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">0.9</span>):</span><br><span class="line">                    cc = <span class="string">'darkblue'</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">0.9</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">1.2</span>):</span><br><span class="line">                    cc = <span class="string">'lime'</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">1.2</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">1.5</span>):</span><br><span class="line">                    cc = <span class="string">'#5cac2d'</span> <span class="comment"># grass</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">1.5</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">1.8</span>):</span><br><span class="line">                    cc = <span class="string">'#1f6357'</span> <span class="comment"># dark green blue</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">1.8</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">2.1</span>):</span><br><span class="line">                    cc = <span class="string">'#fedf08'</span> <span class="comment">#dandelion</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">2.1</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">2.4</span>):</span><br><span class="line">                    cc = <span class="string">'#ac7e04'</span> <span class="comment">#lemon yellow</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">2.4</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">2.7</span>):</span><br><span class="line">                    cc = <span class="string">'#EE7600'</span> <span class="comment">#mustard brown</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">2.7</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">3.0</span>):</span><br><span class="line">                    cc = <span class="string">'#ffb19a'</span> <span class="comment">#pale salmon</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">3.0</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">3.3</span>):</span><br><span class="line">                    cc = <span class="string">'red'</span></span><br><span class="line">                <span class="keyword">if</span> np.any(d[j, i] &gt; <span class="number">3.3</span>) <span class="keyword">and</span> np.any(d[j, i] &lt;= <span class="number">3.6</span>):</span><br><span class="line">                    cc = <span class="string">'#CD1076'</span> <span class="comment">#deep red</span></span><br><span class="line">                <span class="keyword">if</span> (j%<span class="number">5</span>==<span class="number">0</span> <span class="keyword">and</span> j&lt;=nt<span class="number">-3</span>):</span><br><span class="line">                    cwind = ax.quiver(second[j+<span class="number">1</span>, i],third[j+<span class="number">1</span>, i],vv[j+<span class="number">1</span>, i],ww[j+<span class="number">1</span>, i],color=<span class="string">'#9900ff'</span>,width=<span class="number">0.0060</span>,scale=<span class="number">60</span>,alpha=<span class="number">1</span>)</span><br><span class="line">                figure1 = ax.plot(second[j:j + <span class="number">2</span>, i],</span><br><span class="line">                                  third[j:j + <span class="number">2</span>, i],</span><br><span class="line">                                  color=cc,</span><br><span class="line">                                  lw=<span class="number">2.0</span>)</span><br><span class="line">                j += <span class="number">1</span></span><br><span class="line">            kdiw += <span class="number">1</span></span><br><span class="line">            ax.quiverkey(cwind,<span class="number">0.81</span>,<span class="number">0.91</span>,<span class="number">5</span>,<span class="string">"5m·$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$"</span>,labelpos=<span class="string">'E'</span>,coordinates=<span class="string">'axes'</span>,fontproperties=&#123;<span class="string">'size'</span>:<span class="number">20</span>,<span class="string">'family'</span>:<span class="string">'Times New Roman'</span>&#125;)</span><br><span class="line">            x_major_locator = MultipleLocator(<span class="number">0.05</span>)</span><br><span class="line">            ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">            y_major_locator = MultipleLocator(<span class="number">1</span>)</span><br><span class="line">            ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line">            <span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">            ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment">#    plt.xlim(minlon, maxlon+0.002,0.05)</span></span><br><span class="line">            plt.xlim(minlat, maxlat+<span class="number">0.002</span>,<span class="number">0.05</span>)</span><br><span class="line">            plt.ylim(<span class="number">0</span>, maxhei+<span class="number">1</span>,<span class="number">1</span>)</span><br><span class="line">        <span class="comment">#    plt.xticks(rotation=-15+20)</span></span><br><span class="line">        <span class="comment">#    plt.yticks(rotation=40+20)</span></span><br><span class="line">        <span class="comment">#    ax.set_xlabel("Longtitude", fontsize=18,labelpad =10)</span></span><br><span class="line">        <span class="comment">#    ax.set_xlim(minlon, maxlon+0.002)</span></span><br><span class="line">            ax.set_xlabel(<span class="string">"Latitude"</span>, fontsize=<span class="number">18</span>,labelpad =<span class="number">10</span>)</span><br><span class="line">            ax.set_xlim(minlat, maxlat+<span class="number">0.002</span>)</span><br><span class="line">            ax.set_ylabel(<span class="string">"Height (km)"</span>, fontsize=<span class="number">18</span>)</span><br><span class="line">            ax.set_ylim(<span class="number">0</span>, maxhei+<span class="number">1</span>)</span><br><span class="line">            <span class="keyword">if</span> np.any((gyglat)==<span class="number">1</span>):</span><br><span class="line">                print(<span class="string">"cnm,要改"</span>,minlat)</span><br><span class="line">                maxlat = float(int(math.ceil((maxlat<span class="number">-0.0002</span>) * <span class="number">100</span> / <span class="number">2</span>) *<span class="number">2</span>)/<span class="number">100</span>)</span><br><span class="line">                minlat = float(int(math.floor((minlat+<span class="number">0.0002</span>) * <span class="number">100</span> / <span class="number">2</span>) *<span class="number">2</span>)/<span class="number">100</span>)</span><br><span class="line">                print(<span class="string">"cnm,要改"</span>,float(int(math.floor(minlat * <span class="number">100</span> / <span class="number">2</span>) *<span class="number">2</span>)/<span class="number">100</span>))</span><br><span class="line">                x_major_locator = MultipleLocator(<span class="number">0.02</span>)</span><br><span class="line">                ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">                plt.xlim(minlat, maxlat+<span class="number">0.002</span>,<span class="number">0.02</span>)</span><br><span class="line">                ax.set_xlim(minlat, maxlat+<span class="number">0.002</span>)</span><br><span class="line">                print(<span class="string">"cnm,要改"</span>)</span><br><span class="line">        </span><br><span class="line">            plt.tight_layout() <span class="comment"># xlabel 坐标轴显示不全</span></span><br><span class="line">            <span class="comment">#----------------------------------------------------------</span></span><br><span class="line">            <span class="comment"># set figure information</span></span><br><span class="line">            <span class="comment">#ax.set_title("冰雹增长轨迹（水平投影）")</span></span><br><span class="line">            <span class="comment">#ax.set_zlabel("Height", fontsize=15)</span></span><br><span class="line">            <span class="comment">#plt.xlabel('x1', fontsize=7) #xlab</span></span><br><span class="line">            <span class="comment">#plt.ylabel('y1', fontsize=7) #ylabel</span></span><br><span class="line">            <span class="comment">#plt.zlabel('h1', fontsize=7) #ylabel</span></span><br><span class="line">            <span class="comment">#z_major_locator = MultipleLocator(1) #y interval</span></span><br><span class="line">            ax = plt.gca()</span><br><span class="line">            <span class="comment">#ax.yaxis.set_major_locator(z_major_locator)</span></span><br><span class="line">            <span class="comment">#plt.xlim(-3, 40) #xmax=11,xmin=-0.5</span></span><br><span class="line">            <span class="comment">#plt.ylim(25, 60) #xin=-5,xmax=110</span></span><br><span class="line">            <span class="comment">#----------------------------------------------------------</span></span><br><span class="line">            <span class="comment">#    x_major_locator = MultipleLocator(0.5)</span></span><br><span class="line">            <span class="comment">#    y_major_locator = MultipleLocator(0.5)</span></span><br><span class="line">            <span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">            ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line">            <span class="comment">#-----------------------------------------------------------</span></span><br><span class="line">            plt.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">            labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">            [label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">            plt.subplots_adjust(left=<span class="number">0.21</span>, bottom=<span class="number">0.185</span>)</span><br><span class="line">        <span class="comment">#    plt.subplots_adjust(left=0.05, bottom=0.1)</span></span><br><span class="line">            <span class="keyword">for</span> tick <span class="keyword">in</span> ax.yaxis.get_major_ticks()[:]:</span><br><span class="line">                tick.set_pad(<span class="number">12</span>)</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> ax.yaxis.get_ticklines():</span><br><span class="line">                <span class="comment"># line is a Line2D instance</span></span><br><span class="line">                line.set_color(<span class="string">'black'</span>)</span><br><span class="line">                line.set_markersize(<span class="number">7</span>)</span><br><span class="line">                line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line">            <span class="keyword">for</span> tick <span class="keyword">in</span> ax.xaxis.get_major_ticks()[:]:</span><br><span class="line">                tick.set_pad(<span class="number">12</span>)</span><br><span class="line">            <span class="keyword">for</span> line <span class="keyword">in</span> ax.xaxis.get_ticklines():</span><br><span class="line">                <span class="comment"># line is a Line2D instance</span></span><br><span class="line">                line.set_color(<span class="string">'black'</span>)</span><br><span class="line">                line.set_markersize(<span class="number">7</span>)</span><br><span class="line">                line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line">            bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">            ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">            ax.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">            ax.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">            ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line">            </span><br><span class="line">            <span class="comment">#y_ticks = ax.set_yticks([36])</span></span><br><span class="line">            <span class="comment">#y_labels = ax.set_yticklabels(["one"])</span></span><br><span class="line">        </span><br><span class="line">            plt.savefig(<span class="string">"./kmeans-latitude-K="</span> + str(k+<span class="number">1</span>)+ <span class="string">"-"</span>+ str(kdiw)+<span class="string">".png"</span>, dpi=<span class="number">500</span>)</span><br><span class="line">            plt.close()</span><br></pre></td></tr></table></figure>
<h3 id="冰雹轨迹散点图"><a href="#冰雹轨迹散点图" class="headerlink" title="冰雹轨迹散点图"></a>冰雹轨迹散点图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%86%B0%E9%9B%B9%E8%BD%A8%E8%BF%B9%E6%95%A3%E7%82%B9%E5%9B%BE/scatter-%E4%BE%8B%E5%9B%BE.png" class>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.pyplot <span class="keyword">import</span> MultipleLocator</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> interp1d</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> mpatches</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> interpolate</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.basemap <span class="keyword">import</span> Basemap</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"><span class="comment"># define variable</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./Trajectory-0.5.txt"</span>))</span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line">print(<span class="string">"nn="</span>, nn)</span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line">print(<span class="string">"nt="</span>, nt)</span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">data1 = np.loadtxt(<span class="string">"./Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, nt:<span class="number">2</span> * nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">2</span> * nt:<span class="number">3</span> * nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn] = np.transpose(data1[<span class="number">0</span>:nn, <span class="number">3</span> * nt:<span class="number">4</span> * nt])</span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">5</span>, <span class="number">6</span>))</span><br><span class="line">fig.subplots_adjust(left=<span class="number">0.22</span>, bottom=<span class="number">0.18</span>, right=<span class="number">0.95</span>, top=<span class="number">0.73</span>)</span><br><span class="line">ax = fig.gca()</span><br><span class="line"><span class="comment"># 筛选出满足直径在0.5-1cm 且处于两个区域范围内的轨迹</span></span><br><span class="line"><span class="comment">#iw1 = np.where(((d[nt - 1, :] &gt;= 0.5) &amp; (d[nt - 1, :] &lt; 1)) &amp; ((</span></span><br><span class="line"><span class="comment">#    (first_2000[nt - 1, :] &gt;= 104.98) &amp; (first_2000[nt - 1, :] &lt;= 105.5)</span></span><br><span class="line"><span class="comment">#    &amp; (second_2000[nt - 1, :] &gt;= 35.4) &amp; (second_2000[nt - 1, :] &lt;= 36.2))</span></span><br><span class="line"><span class="comment">#               | ((first_2000[nt - 1, :] &gt;= 105.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (first_2000[nt - 1, :] &lt;= 106.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &gt;= 36.00)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &lt;= 36.40))))</span></span><br><span class="line">iw1 = np.where((d[nt - <span class="number">1</span>, :] &gt;= <span class="number">0.5</span>) &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.0</span>))</span><br><span class="line">ax.scatter(np.transpose(first_2000[nt - <span class="number">1</span>, iw1]),</span><br><span class="line">           np.transpose(second_2000[nt - <span class="number">1</span>, iw1]),</span><br><span class="line">           alpha=<span class="number">0.8</span>,</span><br><span class="line">           edgecolors=<span class="string">'k'</span>,</span><br><span class="line">           linewidths=<span class="number">0.2</span>,</span><br><span class="line">           s=<span class="number">20</span>,</span><br><span class="line">           label=<span class="string">'number of hail (0.5~1.0cm):   '</span> + str(len(iw1[<span class="number">0</span>])),</span><br><span class="line">           c=<span class="string">'blue'</span>)</span><br><span class="line"><span class="comment">#iw2 = np.where(((d[nt - 1, :] &gt;= 1.0) &amp; (d[nt - 1, :] &lt; 1.5)) &amp; ((</span></span><br><span class="line"><span class="comment">#    (first_2000[nt - 1, :] &gt;= 104.98) &amp; (first_2000[nt - 1, :] &lt;= 105.5)</span></span><br><span class="line"><span class="comment">#    &amp; (second_2000[nt - 1, :] &gt;= 35.4) &amp; (second_2000[nt - 1, :] &lt;= 36.2))</span></span><br><span class="line"><span class="comment">#               | ((first_2000[nt - 1, :] &gt;= 105.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (first_2000[nt - 1, :] &lt;= 106.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &gt;= 36.00)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &lt;= 36.40))))</span></span><br><span class="line">iw2 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.0</span>) &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.5</span>))</span><br><span class="line">ax.scatter(np.transpose(first_2000[nt - <span class="number">1</span>, iw2]),</span><br><span class="line">           np.transpose(second_2000[nt - <span class="number">1</span>, iw2]),</span><br><span class="line">           alpha=<span class="number">0.8</span>,</span><br><span class="line">           edgecolors=<span class="string">'k'</span>,</span><br><span class="line">           linewidths=<span class="number">0.2</span>,</span><br><span class="line">           s=<span class="number">20</span>,</span><br><span class="line">           label=<span class="string">'number of hail (1.0~1.5cm):   '</span> + str(len(iw2[<span class="number">0</span>])),</span><br><span class="line">           c=<span class="string">'green'</span>)</span><br><span class="line"><span class="comment">#iw3 = np.where(((d[nt - 1, :] &gt;= 1.5) &amp; (d[nt - 1, :] &lt; 2.0)) &amp; ((</span></span><br><span class="line"><span class="comment">#    (first_2000[nt - 1, :] &gt;= 104.98) &amp; (first_2000[nt - 1, :] &lt;= 105.5)</span></span><br><span class="line"><span class="comment">#    &amp; (second_2000[nt - 1, :] &gt;= 35.4) &amp; (second_2000[nt - 1, :] &lt;= 36.2))</span></span><br><span class="line"><span class="comment">#               | ((first_2000[nt - 1, :] &gt;= 105.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (first_2000[nt - 1, :] &lt;= 106.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &gt;= 36.00)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &lt;= 36.40))))</span></span><br><span class="line">iw3 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.5</span>) &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.0</span>))</span><br><span class="line">ax.scatter(np.transpose(first_2000[nt - <span class="number">1</span>, iw3]),</span><br><span class="line">           np.transpose(second_2000[nt - <span class="number">1</span>, iw3]),</span><br><span class="line">           alpha=<span class="number">0.8</span>,</span><br><span class="line">           edgecolors=<span class="string">'k'</span>,</span><br><span class="line">           linewidths=<span class="number">0.2</span>,</span><br><span class="line">           s=<span class="number">20</span>,</span><br><span class="line">           label=<span class="string">'number of hail (1.5~2.0cm):   '</span> + str(len(iw3[<span class="number">0</span>])),</span><br><span class="line">           c=<span class="string">'yellow'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#iw4 = np.where((((d[nt - 1, :] &gt;= 2.0)) &amp; (d[nt - 1, :] &lt; 2.5)) &amp; ((</span></span><br><span class="line"><span class="comment">#    (first_2000[nt - 1, :] &gt;= 104.98) &amp; (first_2000[nt - 1, :] &lt;= 105.5)</span></span><br><span class="line"><span class="comment">#    &amp; (second_2000[nt - 1, :] &gt;= 35.4) &amp; (second_2000[nt - 1, :] &lt;= 36.2))</span></span><br><span class="line"><span class="comment">#               | ((first_2000[nt - 1, :] &gt;= 105.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (first_2000[nt - 1, :] &lt;= 106.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &gt;= 36.00)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &lt;= 36.40))))</span></span><br><span class="line">iw4 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.0</span>) &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.5</span>))</span><br><span class="line">ax.scatter(np.transpose(first_2000[nt - <span class="number">1</span>, iw4]),</span><br><span class="line">           np.transpose(second_2000[nt - <span class="number">1</span>, iw4]),</span><br><span class="line">           alpha=<span class="number">0.8</span>,</span><br><span class="line">           edgecolors=<span class="string">'k'</span>,</span><br><span class="line">           linewidths=<span class="number">0.2</span>,</span><br><span class="line">           s=<span class="number">20</span>,</span><br><span class="line">           label=<span class="string">'number of hail (2.0cm~2.5cm):   '</span> + str(len(iw4[<span class="number">0</span>])),</span><br><span class="line">           c=<span class="string">'red'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#iw5 = np.where(((d[nt - 1, :] &gt;= 2.5)) &amp; ((</span></span><br><span class="line"><span class="comment">#    (first_2000[nt - 1, :] &gt;= 104.98) &amp; (first_2000[nt - 1, :] &lt;= 105.5)</span></span><br><span class="line"><span class="comment">#    &amp; (second_2000[nt - 1, :] &gt;= 35.4) &amp; (second_2000[nt - 1, :] &lt;= 36.2))</span></span><br><span class="line"><span class="comment">#               | ((first_2000[nt - 1, :] &gt;= 105.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (first_2000[nt - 1, :] &lt;= 106.6)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &gt;= 36.00)</span></span><br><span class="line"><span class="comment">#                  &amp; (second_2000[nt - 1, :] &lt;= 36.40))))</span></span><br><span class="line">iw5 = np.where(((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.5</span>)))</span><br><span class="line">ax.scatter(np.transpose(first_2000[nt - <span class="number">1</span>, iw5]),</span><br><span class="line">           np.transpose(second_2000[nt - <span class="number">1</span>, iw5]),</span><br><span class="line">           alpha=<span class="number">0.8</span>,</span><br><span class="line">           edgecolors=<span class="string">'k'</span>,</span><br><span class="line">           linewidths=<span class="number">0.2</span>,</span><br><span class="line">           s=<span class="number">20</span>,</span><br><span class="line">           label=<span class="string">'number of hail (&gt;2.5cm):   '</span> + str(len(iw5[<span class="number">0</span>])),</span><br><span class="line">           c=<span class="string">'purple'</span>)</span><br><span class="line"></span><br><span class="line">ax.set_xlabel(<span class="string">"Longtitude"</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">"Latitude"</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">1</span>) <span class="comment">#x interval</span></span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">1</span>) <span class="comment">#y interval</span></span><br><span class="line">ax = plt.gca()</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"><span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">plt.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line"><span class="comment">#plt.subplots_adjust(left=0.21, bottom=0.185)</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.yaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.yaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置图片标签</span></span><br><span class="line">ax.legend(fontsize=<span class="number">12</span>,</span><br><span class="line">          loc=<span class="string">'lower center'</span>,</span><br><span class="line">          bbox_to_anchor=(<span class="number">0.29</span>, <span class="number">1.02</span>, <span class="number">0.5</span>, <span class="number">0.5</span>),</span><br><span class="line">          frameon=<span class="literal">True</span>,</span><br><span class="line">          fancybox=<span class="literal">True</span>,</span><br><span class="line">          framealpha=<span class="number">0.2</span>,</span><br><span class="line">          borderpad=<span class="number">0.3</span>,</span><br><span class="line">          ncol=<span class="number">1</span>,</span><br><span class="line">          markerfirst=<span class="literal">True</span>,</span><br><span class="line">          markerscale=<span class="number">1</span>,</span><br><span class="line">          numpoints=<span class="number">1</span>,</span><br><span class="line">          handlelength=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"><span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line">plt.xlim(<span class="number">104.9827</span>, <span class="number">107.0287</span>) <span class="comment">#确定横轴坐标范围</span></span><br><span class="line">plt.ylim(<span class="number">35.22662</span>, <span class="number">36.88075</span>) <span class="comment">#确定纵轴坐标范围</span></span><br><span class="line"><span class="comment">#-----------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ax.text(105.2, 36.0, 'This is a txt')</span></span><br><span class="line">plt.annotate(<span class="string">"I"</span>, xy=(<span class="number">105.34</span>, <span class="number">36.55</span>), xytext=(<span class="number">105.34</span>, <span class="number">36.55</span>), color=<span class="string">"green"</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">points = [[<span class="number">105.23</span>, <span class="number">36.78</span>], [<span class="number">105.23</span>, <span class="number">36.46</span>], [<span class="number">105.59</span>, <span class="number">36.46</span>], [<span class="number">105.59</span>, <span class="number">36.78</span>]]</span><br><span class="line">line = plt.Polygon(points,</span><br><span class="line">                   closed=<span class="literal">True</span>,</span><br><span class="line">                   fill=<span class="literal">None</span>,</span><br><span class="line">                   edgecolor=<span class="string">'green'</span>,</span><br><span class="line">                   linestyle=<span class="string">'--'</span>)</span><br><span class="line">plt.gca().add_line(line)</span><br><span class="line"></span><br><span class="line">plt.annotate(<span class="string">"II"</span>,</span><br><span class="line">             xy=(<span class="number">106.58</span>, <span class="number">35.30</span>),</span><br><span class="line">             xytext=(<span class="number">106.58</span>, <span class="number">35.30</span>),</span><br><span class="line">             color=<span class="string">"orange"</span>,</span><br><span class="line">             fontsize=<span class="number">15</span>)</span><br><span class="line">points = [[<span class="number">106.33</span>, <span class="number">35.38</span>], [<span class="number">106.33</span>, <span class="number">35.23</span>], [<span class="number">106.80</span>, <span class="number">35.23</span>], [<span class="number">106.80</span>, <span class="number">35.38</span>]]</span><br><span class="line">line = plt.Polygon(points,</span><br><span class="line">                   closed=<span class="literal">True</span>,</span><br><span class="line">                   fill=<span class="literal">None</span>,</span><br><span class="line">                   edgecolor=<span class="string">'orange'</span>,</span><br><span class="line">                   linestyle=<span class="string">'--'</span>)</span><br><span class="line">plt.gca().add_line(line)</span><br><span class="line"></span><br><span class="line">plt.annotate(<span class="string">"III"</span>, xy=(<span class="number">105.10</span>, <span class="number">35.55</span>), xytext=(<span class="number">105.10</span>, <span class="number">35.55</span>), color=<span class="string">"red"</span>, fontsize=<span class="number">15</span>)</span><br><span class="line">points = [[<span class="number">105.00</span>, <span class="number">35.90</span>], [<span class="number">105.00</span>, <span class="number">35.41</span>], [<span class="number">105.39</span>, <span class="number">35.41</span>], [<span class="number">105.39</span>, <span class="number">35.90</span>]]</span><br><span class="line">line = plt.Polygon(points,</span><br><span class="line">                   closed=<span class="literal">True</span>,</span><br><span class="line">                   fill=<span class="literal">None</span>,</span><br><span class="line">                   edgecolor=<span class="string">'red'</span>,</span><br><span class="line">                   linestyle=<span class="string">'--'</span>)</span><br><span class="line">plt.gca().add_line(line)</span><br><span class="line"></span><br><span class="line">plt.annotate(<span class="string">"IV"</span>,</span><br><span class="line">             xy=(<span class="number">106.10</span>, <span class="number">36.30</span>),</span><br><span class="line">             xytext=(<span class="number">106.10</span>, <span class="number">36.30</span>),</span><br><span class="line">             color=<span class="string">"#ac4f06"</span>,</span><br><span class="line">             fontsize=<span class="number">15</span>)</span><br><span class="line">points = [[<span class="number">105.68</span>, <span class="number">36.78</span>], [<span class="number">105.68</span>, <span class="number">35.88</span>], [<span class="number">106.75</span>, <span class="number">35.88</span>], [<span class="number">106.75</span>, <span class="number">36.78</span>]]</span><br><span class="line">line = plt.Polygon(points,</span><br><span class="line">                   closed=<span class="literal">True</span>,</span><br><span class="line">                   fill=<span class="literal">None</span>,</span><br><span class="line">                   edgecolor=<span class="string">"#ac4f06"</span>,</span><br><span class="line">                   linestyle=<span class="string">'--'</span>)</span><br><span class="line">plt.gca().add_line(line)</span><br><span class="line"></span><br><span class="line">plt.annotate(<span class="string">"V"</span>,</span><br><span class="line">             xy=(<span class="number">105.05</span>, <span class="number">36.00</span>),</span><br><span class="line">             xytext=(<span class="number">105.05</span>, <span class="number">36.00</span>),</span><br><span class="line">             color=<span class="string">"purple"</span>,</span><br><span class="line">             fontsize=<span class="number">15</span>)</span><br><span class="line">points = [[<span class="number">105.00</span>, <span class="number">36.13</span>], [<span class="number">105.00</span>, <span class="number">35.83</span>], [<span class="number">105.21</span>, <span class="number">35.83</span>], [<span class="number">105.21</span>, <span class="number">36.13</span>]]</span><br><span class="line">line = plt.Polygon(points,</span><br><span class="line">                   closed=<span class="literal">True</span>,</span><br><span class="line">                   fill=<span class="literal">None</span>,</span><br><span class="line">                   edgecolor=<span class="string">'purple'</span>,</span><br><span class="line">                   linestyle=<span class="string">'--'</span>)</span><br><span class="line">plt.gca().add_line(line)</span><br><span class="line"></span><br><span class="line"><span class="comment">#fig = plt.figure()</span></span><br><span class="line">ax = fig.add_axes([<span class="number">0.22</span>, <span class="number">0.179</span>, <span class="number">0.73</span>, <span class="number">0.55</span>], frameon=<span class="literal">False</span>)</span><br><span class="line">ax.set_alpha(<span class="number">0</span>)</span><br><span class="line">m = Basemap(projection=<span class="string">'mill'</span>,</span><br><span class="line">            llcrnrlat=<span class="number">35.227</span>,</span><br><span class="line">            llcrnrlon=<span class="number">104.98</span>,</span><br><span class="line">            urcrnrlon=<span class="number">107.03</span>,</span><br><span class="line">            urcrnrlat=<span class="number">36.88</span>)</span><br><span class="line">m.readshapefile(<span class="string">'help/gadm36_CHN_shp/gadm36_CHN_1'</span>, <span class="string">'china'</span>,</span><br><span class="line">                linewidth=<span class="number">2</span>) <span class="comment">#读取省份数据</span></span><br><span class="line">m.readshapefile(<span class="string">'help/gadm36_TWN_shp/gadm36_TWN_1'</span>, <span class="string">'tw'</span>, linewidth=<span class="number">2</span>) <span class="comment">#读取台湾的数据</span></span><br><span class="line">m.ax = ax</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.show()</span></span><br><span class="line">plt.savefig(<span class="string">'./scatter.png'</span>, dpi=<span class="number">500</span>)</span><br></pre></td></tr></table></figure>
<h3 id="四组CCN的箱线图"><a href="#四组CCN的箱线图" class="headerlink" title="四组CCN的箱线图"></a>四组CCN的箱线图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E5%9B%9B%E7%BB%84CCN%E7%9A%84%E7%AE%B1%E7%BA%BF%E5%9B%BE/W-box-%E4%BE%8B%E5%9B%BE.png" class>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> mpl_toolkits.axisartist.parasite_axes <span class="keyword">import</span> HostAxes, ParasiteAxes</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.pyplot <span class="keyword">import</span> MultipleLocator</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">##### ccn=50</span></span><br><span class="line"><span class="comment">### 数据读取</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./ccn-50/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./ccn-50/data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-50/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./ccn-50/order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line"><span class="comment">#print("nn=", nn)</span></span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line"><span class="comment">#print("nt=", nt)</span></span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">dlt = np.empty([nt, nn], dtype=float)</span><br><span class="line">qc = np.empty([nt, nn], dtype=float)</span><br><span class="line">qr = np.empty([nt, nn], dtype=float)</span><br><span class="line">xw = np.empty([nt, nn], dtype=float)</span><br><span class="line">xt = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpc2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpr2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xphwet = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">hail = np.loadtxt(<span class="string">"./ccn-50/data/Hail-0.5.txt"</span>)</span><br><span class="line">hydro = np.loadtxt(<span class="string">"./ccn-50/data/Hydrometer-0.5.txt"</span>)</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-50/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line"></span><br><span class="line">dlt[<span class="number">0</span>:nt - <span class="number">2</span>, :] = (d[<span class="number">1</span>:nt - <span class="number">1</span>, :] - d[<span class="number">0</span>:nt - <span class="number">2</span>, :]) * <span class="number">60</span> / <span class="number">5</span></span><br><span class="line">dlt[nt - <span class="number">1</span>, :] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">qc[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">qr[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])</span><br><span class="line">xw[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">0.01</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">xt[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt]) - <span class="number">273.0</span></span><br><span class="line">xpc2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt])</span><br><span class="line">xpr2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">xphwet[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">4</span>*nt:<span class="number">5</span>*nt])</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 获取y_pred</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'./ccn-50/y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first_2000[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            first_2000[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，min'</span></span><br><span class="line">xmax = np.array(first_2000).max()</span><br><span class="line">xmin = np.array(first_2000).min()</span><br><span class="line"><span class="comment">#print('xmin=', xmin, '  ', 'xmax=', xmax)</span></span><br><span class="line">ymax = np.array(second_2000).max()</span><br><span class="line">ymin = np.array(second_2000).min()</span><br><span class="line"><span class="comment">#print('ymin=', ymin, '  ', 'ymax=', ymax)</span></span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"><span class="comment">## 5类轨迹</span></span><br><span class="line">wmaxk1d = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>)]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#print("K=", k)</span></span><br><span class="line">    <span class="comment">#    #print("第", k + 1, "类轨迹数=", len(iw[0]))</span></span><br><span class="line">    <span class="comment">#    #print("fuck", y_pred)</span></span><br><span class="line">    <span class="comment">#    #print("fuck", d[nt - 1, :])</span></span><br><span class="line">    <span class="comment">#    #print("fuck", len(y_pred))</span></span><br><span class="line">    <span class="comment">##print("fuck", len(d[nt - 1, :]))</span></span><br><span class="line">    iw1 = np.where((d[nt - <span class="number">1</span>, :] &gt;= <span class="number">0.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.0</span>))</span><br><span class="line">    iw2 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.5</span>))</span><br><span class="line">    iw3 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.0</span>))</span><br><span class="line">    iw4 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.5</span>))</span><br><span class="line">    iw5 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.5</span>))</span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diw = [iw1, iw2, iw3, iw4, iw5]</span><br><span class="line">    <span class="keyword">for</span> nd <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        wmaxk1d[nd] = np.amax(xw[:, diw[nd][<span class="number">0</span>]], axis=<span class="number">0</span>)</span><br><span class="line">data = wmaxk1d</span><br><span class="line"></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">10</span>, <span class="number">4</span>))</span><br><span class="line">fig.subplots_adjust(left=<span class="number">0.10</span>, bottom=<span class="number">0.10</span>, right=<span class="number">0.98</span>, top=<span class="number">0.90</span>)</span><br><span class="line">ax = fig.gca()</span><br><span class="line"><span class="comment">#ax = plt.subplot(411)</span></span><br><span class="line"><span class="comment">#箱型图名称</span></span><br><span class="line">labels = [<span class="string">"0.5~1"</span>, <span class="string">"1~1.5"</span>, <span class="string">"1.5~2"</span>, <span class="string">"2~2.5"</span>, <span class="string">"&gt;2.5"</span>]</span><br><span class="line"><span class="comment">#labels = ["I", "II", "III", "IV", "V"]</span></span><br><span class="line"><span class="comment">#三个箱型图的颜色 RGB （均为0~1的数据）</span></span><br><span class="line"><span class="comment">#colors = [(202 / 255., 96 / 255., 17 / 255.),</span></span><br><span class="line"><span class="comment">#          (255 / 255., 217 / 255., 102 / 255.),</span></span><br><span class="line"><span class="comment">#          (222 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (102 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (58 / 255., 128 / 255., 68 / 255.)]</span></span><br><span class="line">colors = [<span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"red"</span>, <span class="string">"purple"</span>]</span><br><span class="line"><span class="comment">#绘制箱型图</span></span><br><span class="line"><span class="comment">#patch_artist=True--&gt;箱型可以更换颜色，positions=(1,1.4,1.8)--&gt;将同一组的三个箱间隔设置为0.4，widths=0.3--&gt;每个箱宽度为0.3</span></span><br><span class="line">bplot = ax.boxplot(data,</span><br><span class="line">                   patch_artist=<span class="literal">True</span>,</span><br><span class="line">                   labels=labels,</span><br><span class="line">                   positions=(<span class="number">1.0</span>, <span class="number">1.5</span>, <span class="number">2.0</span>, <span class="number">2.5</span>, <span class="number">3.0</span>),</span><br><span class="line">                   showfliers=<span class="literal">False</span>,</span><br><span class="line">                   widths=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment">#将三个箱分别上色</span></span><br><span class="line"><span class="keyword">for</span> patch, color <span class="keyword">in</span> zip(bplot[<span class="string">'boxes'</span>], colors):</span><br><span class="line">    patch.set_facecolor(color)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x_position = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>]</span><br><span class="line">x_position_fmt = [<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>]</span><br><span class="line">plt.xticks([i <span class="keyword">for</span> i <span class="keyword">in</span> x_position], x_position_fmt, fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.ylabel('CWC  ($\mathregular&#123;10^&#123;-1&#125;&#125;$ g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)',</span></span><br><span class="line"><span class="comment">#           fontsize=18)</span></span><br><span class="line">plt.grid(linestyle=<span class="string">"--"</span>, alpha=<span class="number">0.3</span>) <span class="comment">#绘制图中虚线 透明度0.3</span></span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="number">13</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">30</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">30</span>)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">10</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">ax.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##### ccn=200</span></span><br><span class="line"><span class="comment">### 数据读取</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./ccn-200/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./ccn-200/data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-200/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./ccn-200/order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line"><span class="comment">#print("nn=", nn)</span></span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line"><span class="comment">#print("nt=", nt)</span></span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">dlt = np.empty([nt, nn], dtype=float)</span><br><span class="line">qc = np.empty([nt, nn], dtype=float)</span><br><span class="line">qr = np.empty([nt, nn], dtype=float)</span><br><span class="line">xw = np.empty([nt, nn], dtype=float)</span><br><span class="line">xt = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpc2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpr2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xphwet = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">hail = np.loadtxt(<span class="string">"./ccn-200/data/Hail-0.5.txt"</span>)</span><br><span class="line">hydro = np.loadtxt(<span class="string">"./ccn-200/data/Hydrometer-0.5.txt"</span>)</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-200/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line"></span><br><span class="line">dlt[<span class="number">0</span>:nt - <span class="number">2</span>, :] = (d[<span class="number">1</span>:nt - <span class="number">1</span>, :] - d[<span class="number">0</span>:nt - <span class="number">2</span>, :]) * <span class="number">60</span> / <span class="number">5</span></span><br><span class="line">dlt[nt - <span class="number">1</span>, :] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">qc[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">qr[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])</span><br><span class="line">xw[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">0.01</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">xt[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt]) - <span class="number">273.0</span></span><br><span class="line">xpc2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt])</span><br><span class="line">xpr2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">xphwet[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">4</span>*nt:<span class="number">5</span>*nt])</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 获取y_pred</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'./ccn-200/y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first_2000[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            first_2000[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，min'</span></span><br><span class="line">xmax = np.array(first_2000).max()</span><br><span class="line">xmin = np.array(first_2000).min()</span><br><span class="line"><span class="comment">#print('xmin=', xmin, '  ', 'xmax=', xmax)</span></span><br><span class="line">ymax = np.array(second_2000).max()</span><br><span class="line">ymin = np.array(second_2000).min()</span><br><span class="line"><span class="comment">#print('ymin=', ymin, '  ', 'ymax=', ymax)</span></span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"><span class="comment">## 5类轨迹</span></span><br><span class="line">wmaxk1d = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>)]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#print("K=", k)</span></span><br><span class="line">    <span class="comment">#    #print("第", k + 1, "类轨迹数=", len(iw[0]))</span></span><br><span class="line">    <span class="comment">#    #print("fuck", y_pred)</span></span><br><span class="line">    <span class="comment">#    #print("fuck", d[nt - 1, :])</span></span><br><span class="line">    <span class="comment">#    #print("fuck", len(y_pred))</span></span><br><span class="line">    <span class="comment">##print("fuck", len(d[nt - 1, :]))</span></span><br><span class="line">    iw1 = np.where((d[nt - <span class="number">1</span>, :] &gt;= <span class="number">0.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.0</span>))</span><br><span class="line">    iw2 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.5</span>))</span><br><span class="line">    iw3 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.0</span>))</span><br><span class="line">    iw4 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.5</span>))</span><br><span class="line">    iw5 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.5</span>))</span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diw = [iw1, iw2, iw3, iw4, iw5]</span><br><span class="line">    <span class="keyword">for</span> nd <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        wmaxk1d[nd] = np.amax(xw[:, diw[nd][<span class="number">0</span>]], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">data = wmaxk1d</span><br><span class="line"></span><br><span class="line"><span class="comment">#箱型图名称</span></span><br><span class="line">labels = [<span class="string">"0.5~1"</span>, <span class="string">"1~1.5"</span>, <span class="string">"1.5~2"</span>, <span class="string">"2~2.5"</span>, <span class="string">"&gt;2.5"</span>]</span><br><span class="line"><span class="comment">#labels = ["I", "II", "III", "IV", "V"]</span></span><br><span class="line"><span class="comment">#三个箱型图的颜色 RGB （均为0~1的数据）</span></span><br><span class="line"><span class="comment">#colors = [(202 / 255., 96 / 255., 17 / 255.),</span></span><br><span class="line"><span class="comment">#          (255 / 255., 217 / 255., 102 / 255.),</span></span><br><span class="line"><span class="comment">#          (222 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (102 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (58 / 255., 128 / 255., 68 / 255.)]</span></span><br><span class="line">colors = [<span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"red"</span>, <span class="string">"purple"</span>]</span><br><span class="line"><span class="comment">#绘制箱型图</span></span><br><span class="line"><span class="comment">#patch_artist=True--&gt;箱型可以更换颜色，positions=(1,1.4,1.8)--&gt;将同一组的三个箱间隔设置为0.4，widths=0.3--&gt;每个箱宽度为0.3</span></span><br><span class="line">bplot = ax.boxplot(data,</span><br><span class="line">                   patch_artist=<span class="literal">True</span>,</span><br><span class="line">                   labels=labels,</span><br><span class="line">                   positions=(<span class="number">4.0</span>, <span class="number">4.5</span>, <span class="number">5.0</span>, <span class="number">5.5</span>, <span class="number">6.0</span>),</span><br><span class="line">                   showfliers=<span class="literal">False</span>,</span><br><span class="line">                   widths=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment">#将三个箱分别上色</span></span><br><span class="line"><span class="keyword">for</span> patch, color <span class="keyword">in</span> zip(bplot[<span class="string">'boxes'</span>], colors):</span><br><span class="line">    patch.set_facecolor(color)</span><br><span class="line"></span><br><span class="line">x_position = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>]</span><br><span class="line">x_position_fmt = [<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>]</span><br><span class="line">plt.xticks([i <span class="keyword">for</span> i <span class="keyword">in</span> x_position], x_position_fmt, fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.ylabel('CWC  ($\mathregular&#123;10^&#123;-1&#125;&#125;$ g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)',</span></span><br><span class="line"><span class="comment">#           fontsize=18)</span></span><br><span class="line">plt.grid(linestyle=<span class="string">"--"</span>, alpha=<span class="number">0.3</span>) <span class="comment">#绘制图中虚线 透明度0.3</span></span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="number">13</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">30</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">30</span>)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">10</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line">ax.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#plt.show()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">##### ccn=2000</span></span><br><span class="line"><span class="comment">### 数据读取</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./ccn-2000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./ccn-2000/data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-2000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./ccn-2000/order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line"><span class="comment">#print("nn=", nn)</span></span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line"><span class="comment">#print("nt=", nt)</span></span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">dlt = np.empty([nt, nn], dtype=float)</span><br><span class="line">qc = np.empty([nt, nn], dtype=float)</span><br><span class="line">qr = np.empty([nt, nn], dtype=float)</span><br><span class="line">xw = np.empty([nt, nn], dtype=float)</span><br><span class="line">xt = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpc2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpr2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xphwet = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">hail = np.loadtxt(<span class="string">"./ccn-2000/data/Hail-0.5.txt"</span>)</span><br><span class="line">hydro = np.loadtxt(<span class="string">"./ccn-2000/data/Hydrometer-0.5.txt"</span>)</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-2000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line"></span><br><span class="line">dlt[<span class="number">0</span>:nt - <span class="number">2</span>, :] = (d[<span class="number">1</span>:nt - <span class="number">1</span>, :] - d[<span class="number">0</span>:nt - <span class="number">2</span>, :]) * <span class="number">60</span> / <span class="number">5</span></span><br><span class="line">dlt[nt - <span class="number">1</span>, :] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">qc[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">qr[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])</span><br><span class="line">xw[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">0.01</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">xt[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt]) - <span class="number">273.0</span></span><br><span class="line">xpc2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt])</span><br><span class="line">xpr2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">xphwet[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">4</span>*nt:<span class="number">5</span>*nt])</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 获取y_pred</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'./ccn-2000/y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first_2000[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            first_2000[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，min'</span></span><br><span class="line">xmax = np.array(first_2000).max()</span><br><span class="line">xmin = np.array(first_2000).min()</span><br><span class="line"><span class="comment">#print('xmin=', xmin, '  ', 'xmax=', xmax)</span></span><br><span class="line">ymax = np.array(second_2000).max()</span><br><span class="line">ymin = np.array(second_2000).min()</span><br><span class="line"><span class="comment">#print('ymin=', ymin, '  ', 'ymax=', ymax)</span></span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"><span class="comment">## 5类轨迹</span></span><br><span class="line">wmaxk1d = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>)]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#print("K=", k)</span></span><br><span class="line">    <span class="comment">#    #print("第", k + 1, "类轨迹数=", len(iw[0]))</span></span><br><span class="line">    <span class="comment">#    #print("fuck", y_pred)</span></span><br><span class="line">    <span class="comment">#    #print("fuck", d[nt - 1, :])</span></span><br><span class="line">    <span class="comment">#    #print("fuck", len(y_pred))</span></span><br><span class="line">    <span class="comment">##print("fuck", len(d[nt - 1, :]))</span></span><br><span class="line">    iw1 = np.where((d[nt - <span class="number">1</span>, :] &gt;= <span class="number">0.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.0</span>))</span><br><span class="line">    iw2 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.5</span>))</span><br><span class="line">    iw3 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.0</span>))</span><br><span class="line">    iw4 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.5</span>))</span><br><span class="line">    iw5 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.5</span>))</span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diw = [iw1, iw2, iw3, iw4, iw5]</span><br><span class="line">    <span class="keyword">for</span> nd <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        wmaxk1d[nd] = np.amax(xw[:, diw[nd][<span class="number">0</span>]], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">data = wmaxk1d</span><br><span class="line"></span><br><span class="line"><span class="comment">#箱型图名称</span></span><br><span class="line">labels = [<span class="string">"0.5~1"</span>, <span class="string">"1~1.5"</span>, <span class="string">"1.5~2"</span>, <span class="string">"2~2.5"</span>, <span class="string">"&gt;2.5"</span>]</span><br><span class="line"><span class="comment">#labels = ["I", "II", "III", "IV", "V"]</span></span><br><span class="line"><span class="comment">#三个箱型图的颜色 RGB （均为0~1的数据）</span></span><br><span class="line"><span class="comment">#colors = [(202 / 255., 96 / 255., 17 / 255.),</span></span><br><span class="line"><span class="comment">#          (255 / 255., 217 / 255., 102 / 255.),</span></span><br><span class="line"><span class="comment">#          (222 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (102 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (58 / 255., 128 / 255., 68 / 255.)]</span></span><br><span class="line">colors = [<span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"red"</span>, <span class="string">"purple"</span>]</span><br><span class="line"><span class="comment">#绘制箱型图</span></span><br><span class="line"><span class="comment">#patch_artist=True--&gt;箱型可以更换颜色，positions=(1,1.4,1.8)--&gt;将同一组的三个箱间隔设置为0.4，widths=0.3--&gt;每个箱宽度为0.3</span></span><br><span class="line">bplot = ax.boxplot(data,</span><br><span class="line">                   patch_artist=<span class="literal">True</span>,</span><br><span class="line">                   labels=labels,</span><br><span class="line">                   positions=(<span class="number">7.0</span>, <span class="number">7.5</span>, <span class="number">8.0</span>, <span class="number">8.5</span>, <span class="number">9.0</span>),</span><br><span class="line">                   showfliers=<span class="literal">False</span>,</span><br><span class="line">                   widths=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment">#将三个箱分别上色</span></span><br><span class="line"><span class="keyword">for</span> patch, color <span class="keyword">in</span> zip(bplot[<span class="string">'boxes'</span>], colors):</span><br><span class="line">    patch.set_facecolor(color)</span><br><span class="line"></span><br><span class="line">x_position = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>]</span><br><span class="line">x_position_fmt = [<span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>, <span class="string">""</span>]</span><br><span class="line">plt.xticks([i <span class="keyword">for</span> i <span class="keyword">in</span> x_position], x_position_fmt, fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.ylabel('CWC  ($\mathregular&#123;10^&#123;-1&#125;&#125;$ g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)',</span></span><br><span class="line"><span class="comment">#           fontsize=18)</span></span><br><span class="line">plt.grid(linestyle=<span class="string">"--"</span>, alpha=<span class="number">0.3</span>) <span class="comment">#绘制图中虚线 透明度0.3</span></span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="number">13</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">30</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">30</span>)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">10</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line">ax.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#plt.show()</span></span><br><span class="line"></span><br><span class="line"><span class="comment">##### ccn=10000</span></span><br><span class="line"><span class="comment">### 数据读取</span></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./ccn-10000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">fw = (os.popen(<span class="string">"wc -w &lt;./ccn-10000/data/Trajectory-0.5.txt"</span>))</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-10000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">order = np.loadtxt(<span class="string">"./ccn-10000/order.txt"</span>) <span class="comment">#聚类结果排序</span></span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line"><span class="comment">#print("nn=", nn)</span></span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">4</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line"><span class="comment">#print("nt=", nt)</span></span><br><span class="line">first_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">second_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">third_2000 = np.empty([nt, nn], dtype=float)</span><br><span class="line">d = np.empty([nt, nn], dtype=float)</span><br><span class="line">dlt = np.empty([nt, nn], dtype=float)</span><br><span class="line">qc = np.empty([nt, nn], dtype=float)</span><br><span class="line">qr = np.empty([nt, nn], dtype=float)</span><br><span class="line">xw = np.empty([nt, nn], dtype=float)</span><br><span class="line">xt = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpc2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xpr2h = np.empty([nt, nn], dtype=float)</span><br><span class="line">xphwet = np.empty([nt, nn], dtype=float)</span><br><span class="line"><span class="comment"># load data from file</span></span><br><span class="line"><span class="comment"># you replace this using with open</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">hail = np.loadtxt(<span class="string">"./ccn-10000/data/Hail-0.5.txt"</span>)</span><br><span class="line">hydro = np.loadtxt(<span class="string">"./ccn-10000/data/Hydrometer-0.5.txt"</span>)</span><br><span class="line">data1 = np.loadtxt(<span class="string">"./ccn-10000/data/Trajectory-0.5.txt"</span>)</span><br><span class="line">first_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt] / <span class="number">2</span>)</span><br><span class="line">second_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt] / <span class="number">2</span>)</span><br><span class="line">third_2000[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt] / <span class="number">2</span>)</span><br><span class="line">d[:, <span class="number">0</span>:nn + <span class="number">1</span>] = np.transpose(data1[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line"></span><br><span class="line">dlt[<span class="number">0</span>:nt - <span class="number">2</span>, :] = (d[<span class="number">1</span>:nt - <span class="number">1</span>, :] - d[<span class="number">0</span>:nt - <span class="number">2</span>, :]) * <span class="number">60</span> / <span class="number">5</span></span><br><span class="line">dlt[nt - <span class="number">1</span>, :] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">qc[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">qr[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1000</span> * np.transpose(hydro[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt])</span><br><span class="line">xw[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">0.01</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">0</span>:nt])</span><br><span class="line">xt[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, nt:<span class="number">2</span>*nt]) - <span class="number">273.0</span></span><br><span class="line">xpc2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">2</span>*nt:<span class="number">3</span>*nt])</span><br><span class="line">xpr2h[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">3</span>*nt:<span class="number">4</span>*nt])</span><br><span class="line">xphwet[:, <span class="number">0</span>:nn + <span class="number">1</span>] = <span class="number">1</span> * np.transpose(hail[<span class="number">0</span>:nn + <span class="number">1</span>, <span class="number">4</span>*nt:<span class="number">5</span>*nt])</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># 获取y_pred</span></span><br><span class="line">y_pred = np.loadtxt(<span class="string">'./ccn-10000/y_pred.txt'</span>, delimiter=<span class="string">','</span>)</span><br><span class="line"><span class="comment"># delete some aberrant point</span></span><br><span class="line">i = <span class="number">0</span></span><br><span class="line">j = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(nt):</span><br><span class="line">        <span class="keyword">if</span> np.any(first_2000[j, i] &gt;= <span class="number">999</span>):</span><br><span class="line">            first_2000[j, i] = <span class="number">0</span></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment"># xy坐标max，min'</span></span><br><span class="line">xmax = np.array(first_2000).max()</span><br><span class="line">xmin = np.array(first_2000).min()</span><br><span class="line"><span class="comment">#print('xmin=', xmin, '  ', 'xmax=', xmax)</span></span><br><span class="line">ymax = np.array(second_2000).max()</span><br><span class="line">ymin = np.array(second_2000).min()</span><br><span class="line"><span class="comment">#print('ymin=', ymin, '  ', 'ymax=', ymax)</span></span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">180</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">180</span></span><br><span class="line">first_2000 = <span class="number">104.9827</span> + first_2000 * x_co</span><br><span class="line">second_2000 = <span class="number">35.22662</span> + second_2000 * y_co</span><br><span class="line"><span class="comment">## 5类轨迹</span></span><br><span class="line">wmaxk1d = [<span class="number">0</span> <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">0</span>, <span class="number">5</span>)]</span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#print("K=", k)</span></span><br><span class="line">    <span class="comment">#    #print("第", k + 1, "类轨迹数=", len(iw[0]))</span></span><br><span class="line">    <span class="comment">#    #print("fuck", y_pred)</span></span><br><span class="line">    <span class="comment">#    #print("fuck", d[nt - 1, :])</span></span><br><span class="line">    <span class="comment">#    #print("fuck", len(y_pred))</span></span><br><span class="line">    <span class="comment">##print("fuck", len(d[nt - 1, :]))</span></span><br><span class="line">    iw1 = np.where((d[nt - <span class="number">1</span>, :] &gt;= <span class="number">0.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.0</span>))</span><br><span class="line">    iw2 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">1.5</span>))</span><br><span class="line">    iw3 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">1.5</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.0</span>))</span><br><span class="line">    iw4 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.0</span>)</span><br><span class="line">                   &amp; (d[nt - <span class="number">1</span>, :] &lt;= <span class="number">2.5</span>))</span><br><span class="line">    iw5 = np.where((d[nt - <span class="number">1</span>, :] &gt; <span class="number">2.5</span>))</span><br><span class="line">    <span class="comment"># 被选中聚类轨迹的最大值</span></span><br><span class="line">    diw = [iw1, iw2, iw3, iw4, iw5]</span><br><span class="line">    <span class="keyword">for</span> nd <span class="keyword">in</span> range(<span class="number">5</span>):</span><br><span class="line">        wmaxk1d[nd] = np.amax(xw[:, diw[nd][<span class="number">0</span>]], axis=<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">data = wmaxk1d</span><br><span class="line"></span><br><span class="line"><span class="comment">#箱型图名称</span></span><br><span class="line">labels = [<span class="string">"0.5~1"</span>, <span class="string">"1~1.5"</span>, <span class="string">"1.5~2"</span>, <span class="string">"2~2.5"</span>, <span class="string">"&gt;2.5"</span>]</span><br><span class="line"><span class="comment">#labels = ["I", "II", "III", "IV", "V"]</span></span><br><span class="line"><span class="comment">#三个箱型图的颜色 RGB （均为0~1的数据）</span></span><br><span class="line"><span class="comment">#colors = [(202 / 255., 96 / 255., 17 / 255.),</span></span><br><span class="line"><span class="comment">#          (255 / 255., 217 / 255., 102 / 255.),</span></span><br><span class="line"><span class="comment">#          (222 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (102 / 255., 128 / 255., 68 / 255.),</span></span><br><span class="line"><span class="comment">#          (58 / 255., 128 / 255., 68 / 255.)]</span></span><br><span class="line">colors = [<span class="string">"blue"</span>, <span class="string">"green"</span>, <span class="string">"yellow"</span>, <span class="string">"red"</span>, <span class="string">"purple"</span>]</span><br><span class="line"><span class="comment">#绘制箱型图</span></span><br><span class="line"><span class="comment">#patch_artist=True--&gt;箱型可以更换颜色，positions=(1,1.4,1.8)--&gt;将同一组的三个箱间隔设置为0.4，widths=0.3--&gt;每个箱宽度为0.3</span></span><br><span class="line">bplot = ax.boxplot(data,</span><br><span class="line">                   patch_artist=<span class="literal">True</span>,</span><br><span class="line">                   labels=labels,</span><br><span class="line">                   positions=(<span class="number">10.0</span>, <span class="number">10.5</span>, <span class="number">11.0</span>, <span class="number">11.5</span>, <span class="number">12.0</span>),</span><br><span class="line">                   showfliers=<span class="literal">False</span>,</span><br><span class="line">                   widths=<span class="number">0.3</span>)</span><br><span class="line"><span class="comment">#将三个箱分别上色</span></span><br><span class="line"><span class="keyword">for</span> patch, color <span class="keyword">in</span> zip(bplot[<span class="string">'boxes'</span>], colors):</span><br><span class="line">    patch.set_facecolor(color)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">x_position = [<span class="number">2</span>, <span class="number">5</span>, <span class="number">8</span>, <span class="number">11</span>]</span><br><span class="line"><span class="comment">#x_position_fmt = ["I", "II", "III", "VI", "V"]</span></span><br><span class="line">x_position_fmt = [<span class="string">"CCN=50"</span>, <span class="string">"CCN=200"</span>, <span class="string">"CCN=2000"</span>, <span class="string">"CCN=10000"</span>]</span><br><span class="line">plt.xticks([i <span class="keyword">for</span> i <span class="keyword">in</span> x_position], x_position_fmt, fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.ylabel('CWC  ($\mathregular&#123;10^&#123;-1&#125;&#125;$ g.$\mathregular&#123;kg^&#123;-1&#125;&#125;$)',</span></span><br><span class="line"><span class="comment">#           fontsize=18)</span></span><br><span class="line">plt.grid(linestyle=<span class="string">"--"</span>, alpha=<span class="number">0.3</span>) <span class="comment">#绘制图中虚线 透明度0.3</span></span><br><span class="line">plt.xlim(<span class="number">0</span>, <span class="number">13</span>)</span><br><span class="line">plt.ylim(<span class="number">0</span>, <span class="number">30</span>)</span><br><span class="line">ax.set_ylim(<span class="number">0</span>,<span class="number">30</span>)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">10</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line">ax.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(<span class="number">0</span>)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line">plt.ylabel(<span class="string">'W  (m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$)'</span>,</span><br><span class="line"></span><br><span class="line">           fontsize=<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">plt.savefig(fname=<span class="string">"W-box.png"</span>)</span><br></pre></td></tr></table></figure>
<h3 id="柱状图-子图"><a href="#柱状图-子图" class="headerlink" title="柱状图-子图"></a>柱状图-子图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E6%9F%B1%E7%8A%B6%E5%9B%BE-%E5%AD%90%E5%9B%BE/bar-ccn%25-%E4%BE%8B%E5%9B%BE.png" class>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.axes_grid1.inset_locator <span class="keyword">import</span> inset_axes</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">autolabel</span><span class="params">(rects)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x() + rect.get_width() / <span class="number">2.</span> - <span class="number">0.06</span>,</span><br><span class="line">                 <span class="number">1.03</span> * height,</span><br><span class="line">                 <span class="string">'%s'</span> % round(float(height), <span class="number">1</span>),</span><br><span class="line">                 fontsize=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">autolabel2</span><span class="params">(rects)</span>:</span></span><br><span class="line">    <span class="keyword">for</span> rect <span class="keyword">in</span> rects:</span><br><span class="line">        height = rect.get_height()</span><br><span class="line">        plt.text(rect.get_x() + rect.get_width() / <span class="number">2.</span> - <span class="number">0.06</span>,</span><br><span class="line">                 <span class="number">1.01</span> * height,</span><br><span class="line">                 <span class="string">'%s'</span> % round(float(<span class="number">2</span> * height), <span class="number">1</span>),</span><br><span class="line">                 fontsize=<span class="number">15</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">plt.figure(figsize=(<span class="number">13</span>, <span class="number">4</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment">#解决中文和负号</span></span><br><span class="line"><span class="comment">#plt.rcParams['font.sans-serif'] = ['SimHei']</span></span><br><span class="line"><span class="comment">#plt.rcParams['font.serif'] = ['SimHei']</span></span><br><span class="line"><span class="comment">##plt.rcParams['font.weight'] = "bold"</span></span><br><span class="line"><span class="comment">#plt.rcParams['axes.unicode_minus'] = False</span></span><br><span class="line"></span><br><span class="line">plt.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line">plt.rcParams[<span class="string">'font.serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"><span class="comment">#plt.rcParams['font.weight'] = "bold"</span></span><br><span class="line">plt.rcParams[<span class="string">'axes.unicode_minus'</span>] = <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># xlabel</span></span><br><span class="line">labels = [<span class="string">'CCN=50'</span>, <span class="string">'CCN=200'</span>, <span class="string">'CCN=2000'</span>, <span class="string">'CCN=10000'</span>]</span><br><span class="line"><span class="comment">#d_0_5_1 = np.log([5289, 4283, 4740, 2972])</span></span><br><span class="line"><span class="comment">#d_1_1_5 = np.log([793, 779, 1309, 620])</span></span><br><span class="line"><span class="comment">#d_1_5_2 = np.log([177, 153, 839, 71])</span></span><br><span class="line"><span class="comment">#d_2_2_5 = np.log([38, 34, 429, 8])</span></span><br><span class="line"><span class="comment">#d_2_5 = np.log([9, 13, 94, 2])</span></span><br><span class="line"></span><br><span class="line">d_0_5_1 = np.array([<span class="number">7004</span> / <span class="number">8550</span>, <span class="number">5621</span> / <span class="number">7019</span>, <span class="number">6078</span> / <span class="number">8601</span>, <span class="number">5546</span> / <span class="number">6534</span>])</span><br><span class="line">d_1_1_5 = np.array([<span class="number">1147</span> / <span class="number">8550</span>, <span class="number">1129</span> / <span class="number">7019</span>, <span class="number">1404</span> / <span class="number">8601</span>, <span class="number">882</span> / <span class="number">6534</span>])</span><br><span class="line">d_1_5_2 = np.array([<span class="number">296</span> / <span class="number">8550</span>, <span class="number">226</span> / <span class="number">7019</span>, <span class="number">766</span> / <span class="number">8601</span>, <span class="number">90</span> / <span class="number">6534</span>])</span><br><span class="line">d_2_2_5 = np.array([<span class="number">82</span> / <span class="number">8550</span>, <span class="number">31</span> / <span class="number">7019</span>, <span class="number">322</span> / <span class="number">8601</span>, <span class="number">11</span> / <span class="number">6534</span>])</span><br><span class="line">d_2_5 = np.array([<span class="number">21</span> / <span class="number">8550</span>, <span class="number">12</span> / <span class="number">7019</span>, <span class="number">31</span> / <span class="number">8601</span>, <span class="number">5</span> / <span class="number">6534</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#d_0_5_1 = d_0_5_1 / 2</span></span><br><span class="line"></span><br><span class="line">ax = plt.gca()</span><br><span class="line">x = np.arange(len(labels))</span><br><span class="line">print(x)</span><br><span class="line">width = <span class="number">0.2</span></span><br><span class="line">a = plt.bar(x - <span class="number">1.5</span> * width,</span><br><span class="line">            d_0_5_1 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'0.5~1cm'</span>,</span><br><span class="line">            color=<span class="string">'blue'</span>)</span><br><span class="line">b = plt.bar(x - <span class="number">0.75</span> * width,</span><br><span class="line">            d_1_1_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'1~1.5cm'</span>,</span><br><span class="line">            color=<span class="string">'orange'</span>)</span><br><span class="line">c = plt.bar(x, d_1_5_2 * <span class="number">100</span>, width, label=<span class="string">'1.5-2cm'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">d = plt.bar(x + <span class="number">0.75</span> * width,</span><br><span class="line">            d_2_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'2~2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'red'</span>)</span><br><span class="line">e = plt.bar(x + <span class="number">1.5</span> * width,</span><br><span class="line">            d_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'&gt;2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'purple'</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">####autolabel2(a)</span></span><br><span class="line"><span class="comment">####autolabel(b)</span></span><br><span class="line"><span class="comment">####autolabel(c)</span></span><br><span class="line"><span class="comment">####autolabel(d)</span></span><br><span class="line"><span class="comment">####autolabel(e)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调节label大小</span></span><br><span class="line">tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">20</span>)</span><br><span class="line"><span class="comment">#plt.tick_params(axis='both', labelsize=15)</span></span><br><span class="line">plt.tick_params(axis=<span class="string">'both'</span>, **tkw)</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.yscale("symlog")</span></span><br><span class="line">plt.xticks(x, labels=labels)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ax.set_ylabel("percentage (%)", fontsize=25)</span></span><br><span class="line"><span class="comment">#y = [1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]</span></span><br><span class="line"><span class="comment">#t = [1, 5, 10, 15, 20, 40, 60, 70, 80, 90, 100]</span></span><br><span class="line">y = [<span class="number">0</span>, <span class="number">20</span>, <span class="number">40</span>, <span class="number">60</span>, <span class="number">80</span>, <span class="number">100</span>]</span><br><span class="line">t = [<span class="string">"0"</span>, <span class="string">"20%"</span>, <span class="string">"40%"</span>, <span class="string">"60%"</span>, <span class="string">"80%"</span>, <span class="string">"100%"</span>]</span><br><span class="line">plt.yticks(y, t)</span><br><span class="line"></span><br><span class="line"><span class="comment">#ax.set_ylabel('个数', fontsize=18)</span></span><br><span class="line"><span class="comment">#ax.set_xlabel('统计图', fontsize=18)</span></span><br><span class="line"></span><br><span class="line">ax.legend(loc=<span class="string">'upper right'</span>,</span><br><span class="line">          fontsize=<span class="number">12</span>,</span><br><span class="line">          frameon=<span class="literal">True</span>,</span><br><span class="line">          fancybox=<span class="literal">True</span>,</span><br><span class="line">          framealpha=<span class="number">0.8</span>,</span><br><span class="line">          borderpad=<span class="number">0.3</span>,</span><br><span class="line">          labelspacing=<span class="number">1.0</span>,</span><br><span class="line">          ncol=<span class="number">1</span>,</span><br><span class="line">          markerfirst=<span class="literal">False</span>,</span><br><span class="line">          markerscale=<span class="number">1</span>,</span><br><span class="line">          numpoints=<span class="number">1</span>,</span><br><span class="line">          bbox_to_anchor=(<span class="number">1.133</span>, <span class="number">0.80</span>),</span><br><span class="line">          handlelength=<span class="number">2.3</span>)</span><br><span class="line"></span><br><span class="line">ax.set_ylabel(<span class="string">"Percentage"</span>, fontsize=<span class="number">30</span>)</span><br><span class="line"><span class="comment">#labels = ax.get_xticklabels() + ax.get_yticklabels()</span></span><br><span class="line"><span class="comment">#[label.set_fontname('Times New Roman') for label in labels]</span></span><br><span class="line">plt.title(<span class="string">"Number of Hailstone"</span>, fontsize=<span class="number">30</span>, x=<span class="number">0.5</span>, y=<span class="number">1.03</span>)</span><br><span class="line">plt.tick_params(labelsize=<span class="number">25</span>)</span><br><span class="line"><span class="comment">#labels = ax.get_xticklabels() + ax.get_yticklabels()</span></span><br><span class="line">labelx = ax.get_xticklabels()</span><br><span class="line">labely = ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labelx]</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labely]</span><br><span class="line"><span class="comment"># 横坐标下移</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 边框加粗</span></span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#-----------------------------------------------------</span></span><br><span class="line">ax1 = ax.inset_axes([<span class="number">0.13</span>, <span class="number">0.5</span>, <span class="number">0.145</span>, <span class="number">0.4</span>])</span><br><span class="line">ax1.set_xlim(<span class="number">0</span> - <span class="number">0.25</span>, <span class="number">0.5</span>)</span><br><span class="line">ax1.set_ylim(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment">#a = ax1.bar(x - 1.5 * width,</span></span><br><span class="line"><span class="comment">#            d_0_5_1 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='0.5-1cm',</span></span><br><span class="line"><span class="comment">#            color='blue')</span></span><br><span class="line"><span class="comment">#b = ax1.bar(x - 0.75 * width,</span></span><br><span class="line"><span class="comment">#            d_1_1_5 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='1-1.5cm',</span></span><br><span class="line"><span class="comment">#            color='orange')</span></span><br><span class="line">c = ax1.bar(x, d_1_5_2 * <span class="number">100</span>, width, label=<span class="string">'1.5~2cm'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">d = ax1.bar(x + <span class="number">0.75</span> * width,</span><br><span class="line">            d_2_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'2~2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'red'</span>)</span><br><span class="line">e = ax1.bar(x + <span class="number">1.5</span> * width,</span><br><span class="line">            d_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'&gt;2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'purple'</span>)</span><br><span class="line">tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">16</span>)</span><br><span class="line"><span class="comment">#plt.tick_params(axis='both', labelsize=15)</span></span><br><span class="line">ax1.tick_params(axis=<span class="string">'both'</span>, **tkw)</span><br><span class="line"><span class="comment">#plt.yscale("symlog")</span></span><br><span class="line">ax1.set_xticks([<span class="number">0.</span>])</span><br><span class="line">ax1.set_xticklabels([<span class="string">"CCN=50"</span>])</span><br><span class="line">y = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">t = [<span class="string">"0"</span>, <span class="string">"1%"</span>, <span class="string">"2%"</span>, <span class="string">"3%"</span>, <span class="string">"4%"</span>]</span><br><span class="line">ax1.set_yticks(y)</span><br><span class="line">ax1.set_yticklabels(t)</span><br><span class="line"><span class="comment"># 坐标字体</span></span><br><span class="line"><span class="comment">#labels = ax1.get_xticklabels() + ax1.get_yticklabels()</span></span><br><span class="line">labelx = ax1.get_xticklabels()</span><br><span class="line">labely = ax1.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labelx]</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labely]</span><br><span class="line"><span class="comment"># 横坐标下移</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax1.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax1.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 边框加粗</span></span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax1.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax1.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax1.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax1.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#-----------------------------------------------------</span></span><br><span class="line">ax2 = ax.inset_axes([<span class="number">0.375</span>, <span class="number">0.5</span>, <span class="number">0.1432979</span>, <span class="number">0.4</span>])</span><br><span class="line">ax2.set_xlim(<span class="number">1</span> - <span class="number">0.25</span>, <span class="number">1.5</span>)</span><br><span class="line">ax2.set_ylim(<span class="number">0</span>, <span class="number">4</span>)</span><br><span class="line"><span class="comment">#a = ax2.bar(x - 1.5 * width,</span></span><br><span class="line"><span class="comment">#            d_0_5_1 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='0.5-1cm',</span></span><br><span class="line"><span class="comment">#            color='blue')</span></span><br><span class="line"><span class="comment">#b = ax2.bar(x - 0.75 * width,</span></span><br><span class="line"><span class="comment">#            d_1_1_5 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='1-1.5cm',</span></span><br><span class="line"><span class="comment">#            color='orange')</span></span><br><span class="line">c = ax2.bar(x, d_1_5_2 * <span class="number">100</span>, width, label=<span class="string">'1.5-2cm'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">d = ax2.bar(x + <span class="number">0.75</span> * width,</span><br><span class="line">            d_2_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'2~2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'red'</span>)</span><br><span class="line">e = ax2.bar(x + <span class="number">1.5</span> * width,</span><br><span class="line">            d_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'&gt;2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'purple'</span>)</span><br><span class="line">tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">16</span>)</span><br><span class="line"><span class="comment">#plt.tick_params(axis='both', labelsize=15)</span></span><br><span class="line">ax2.tick_params(axis=<span class="string">'both'</span>, **tkw)</span><br><span class="line"><span class="comment">#plt.yscale("symlog")</span></span><br><span class="line">ax2.set_xticks([<span class="number">1.</span>])</span><br><span class="line">ax2.set_xticklabels([<span class="string">"CCN=200"</span>])</span><br><span class="line">y = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">t = [<span class="string">"0"</span>, <span class="string">"1%"</span>, <span class="string">"2%"</span>, <span class="string">"3%"</span>, <span class="string">"4%"</span>]</span><br><span class="line">ax2.set_yticks(y)</span><br><span class="line">ax2.set_yticklabels(t)</span><br><span class="line"><span class="comment"># 坐标字体</span></span><br><span class="line"><span class="comment">#labels = ax1.get_xticklabels() + ax1.get_yticklabels()</span></span><br><span class="line">labelx = ax2.get_xticklabels()</span><br><span class="line">labely = ax2.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labelx]</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labely]</span><br><span class="line"><span class="comment"># 横坐标下移</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax2.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax2.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 边框加粗</span></span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax2.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax2.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax2.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax2.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#-----------------------------------------------------</span></span><br><span class="line">ax3 = ax.inset_axes([<span class="number">0.615</span>, <span class="number">0.5</span>, <span class="number">0.1432979</span>, <span class="number">0.4</span>])</span><br><span class="line">ax3.set_xlim(<span class="number">2</span> - <span class="number">0.25</span>, <span class="number">2.5</span>)</span><br><span class="line">ax3.set_ylim(<span class="number">0</span>, <span class="number">15</span>)</span><br><span class="line"><span class="comment">#a = ax3.bar(x - 1.5 * width,</span></span><br><span class="line"><span class="comment">#            d_0_5_1 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='0.5-1cm',</span></span><br><span class="line"><span class="comment">#            color='blue')</span></span><br><span class="line"><span class="comment">#b = ax3.bar(x - 0.75 * width,</span></span><br><span class="line"><span class="comment">#            d_1_1_5 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='1-1.5cm',</span></span><br><span class="line"></span><br><span class="line">c = ax3.bar(x, d_1_5_2 * <span class="number">100</span>, width, label=<span class="string">'1.5-2cm'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">d = ax3.bar(x + <span class="number">0.75</span> * width,</span><br><span class="line">            d_2_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'2~2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'red'</span>)</span><br><span class="line">e = ax3.bar(x + <span class="number">1.5</span> * width,</span><br><span class="line">            d_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'&gt;2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'purple'</span>)</span><br><span class="line">tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">16</span>)</span><br><span class="line"><span class="comment">#plt.tick_params(axis='both', labelsize=15)</span></span><br><span class="line">ax3.tick_params(axis=<span class="string">'both'</span>, **tkw)</span><br><span class="line"><span class="comment">#plt.yscale("symlog")</span></span><br><span class="line">ax3.set_xticks([<span class="number">2.0</span>])</span><br><span class="line">ax3.set_xticklabels([<span class="string">"CCN=2000"</span>])</span><br><span class="line">y = [<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>]</span><br><span class="line">t = [<span class="string">"0"</span>, <span class="string">"5%"</span>, <span class="string">"10%"</span>, <span class="string">"15%"</span>]</span><br><span class="line">ax3.set_yticks(y)</span><br><span class="line">ax3.set_yticklabels(t)</span><br><span class="line"><span class="comment"># 坐标字体</span></span><br><span class="line"><span class="comment">#labels = ax1.get_xticklabels() + ax1.get_yticklabels()</span></span><br><span class="line">labelx = ax3.get_xticklabels()</span><br><span class="line">labely = ax3.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labelx]</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labely]</span><br><span class="line"><span class="comment"># 横坐标下移</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax3.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax3.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 边框加粗</span></span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax3.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax3.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax3.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax3.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#-----------------------------------------------------</span></span><br><span class="line">ax4 = ax.inset_axes([<span class="number">0.85</span>, <span class="number">0.5</span>, <span class="number">0.1432979</span>, <span class="number">0.4</span>])</span><br><span class="line">ax4.set_xlim(<span class="number">3</span> - <span class="number">0.25</span>, <span class="number">3.5</span>)</span><br><span class="line">ax4.set_ylim(<span class="number">0</span>, <span class="number">2</span>)</span><br><span class="line"><span class="comment">#a = ax4.bar(x - 1.5 * width,</span></span><br><span class="line"><span class="comment">#            d_0_5_1 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='0.5-1cm',</span></span><br><span class="line"><span class="comment">#            color='blue')</span></span><br><span class="line"><span class="comment">#b = ax4.bar(x - 0.75 * width,</span></span><br><span class="line"><span class="comment">#            d_1_1_5 * 100,</span></span><br><span class="line"><span class="comment">#            width,</span></span><br><span class="line"><span class="comment">#            label='1-1.5cm',</span></span><br><span class="line"><span class="comment">#            color='orange')</span></span><br><span class="line">c = ax4.bar(x, d_1_5_2 * <span class="number">100</span>, width, label=<span class="string">'1.5-2cm'</span>, color=<span class="string">'green'</span>)</span><br><span class="line">d = ax4.bar(x + <span class="number">0.75</span> * width,</span><br><span class="line">            d_2_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'2~2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'red'</span>)</span><br><span class="line">e = ax4.bar(x + <span class="number">1.5</span> * width,</span><br><span class="line">            d_2_5 * <span class="number">100</span>,</span><br><span class="line">            width,</span><br><span class="line">            label=<span class="string">'&gt;2.5cm'</span>,</span><br><span class="line">            color=<span class="string">'purple'</span>)</span><br><span class="line">tkw = dict(size=<span class="number">5</span>, width=<span class="number">1.5</span>, direction=<span class="string">'in'</span>, labelsize=<span class="number">16</span>)</span><br><span class="line"><span class="comment">#plt.tick_params(axis='both', labelsize=15)</span></span><br><span class="line">ax4.tick_params(axis=<span class="string">'both'</span>, **tkw)</span><br><span class="line"><span class="comment">#plt.yscale("symlog")</span></span><br><span class="line">ax4.set_xticks([<span class="number">3.0</span>])</span><br><span class="line">ax4.set_xticklabels([<span class="string">"CCN=10000"</span>])</span><br><span class="line">y = [<span class="number">0</span>, <span class="number">1</span>, <span class="number">2</span>]</span><br><span class="line">t = [<span class="string">"0"</span>, <span class="string">"1%"</span>, <span class="string">"2%"</span>]</span><br><span class="line">ax4.set_yticks(y)</span><br><span class="line">ax4.set_yticklabels(t)</span><br><span class="line"><span class="comment"># 坐标字体</span></span><br><span class="line"><span class="comment">#labels = ax1.get_xticklabels() + ax1.get_yticklabels()</span></span><br><span class="line">labelx = ax4.get_xticklabels()</span><br><span class="line">labely = ax4.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labelx]</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labely]</span><br><span class="line"><span class="comment"># 横坐标下移</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax4.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax4.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="comment"># 边框加粗</span></span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax4.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax4.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax4.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax4.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"><span class="comment">#-----------------------------------------------------</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ax.set_ylabel("percentage (%)", fontsize=25)</span></span><br><span class="line"><span class="comment">#y = [1, 5, 10, 15, 20, 25, 30, 35, 40, 45, 50]</span></span><br><span class="line"><span class="comment">#t = [1, 5, 10, 15, 20, 40, 60, 70, 80, 90, 100]</span></span><br><span class="line"><span class="comment">#ax1.yticks(y, t)</span></span><br><span class="line"><span class="comment">#ax.indicate_inset_zoom(ax)</span></span><br><span class="line"><span class="comment">#x2 = [0, 2]</span></span><br><span class="line"><span class="comment">#y4 = [0, 20]</span></span><br><span class="line"><span class="comment">#new_ax = inset_axes(ax1,</span></span><br><span class="line"><span class="comment">#                    width="40%",</span></span><br><span class="line"><span class="comment">#                    height="20%",</span></span><br><span class="line"><span class="comment">#                    loc="lower left",</span></span><br><span class="line"><span class="comment">#                    bbox_to_anchor=(0.3, 0.1, 1, 1),</span></span><br><span class="line"><span class="comment">#                    bbox_transform=ax1.transAxes)</span></span><br><span class="line"><span class="comment">#new_ax.plot(x2, y4)</span></span><br><span class="line"></span><br><span class="line">plt.savefig(<span class="string">'bar-ccn%.png'</span>)</span><br><span class="line">plt.close</span><br></pre></td></tr></table></figure>
<h3 id="雹胚等值线-上升气流图"><a href="#雹胚等值线-上升气流图" class="headerlink" title="雹胚等值线+上升气流图"></a>雹胚等值线+上升气流图</h3><img src="/blog///2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/%E9%9B%B9%E8%83%9A%E7%AD%89%E5%80%BC%E7%BA%BF+%E4%B8%8A%E5%8D%87%E6%B0%94%E6%B5%81%E5%9B%BE/dzx-qg-%E4%BE%8B%E5%9B%BE.png" class>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="keyword">from</span> sklearn.cluster <span class="keyword">import</span> KMeans</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.mplot3d <span class="keyword">import</span> axes3d</span><br><span class="line"><span class="keyword">import</span> matplotlib.pyplot <span class="keyword">as</span> plt</span><br><span class="line"><span class="keyword">from</span> matplotlib.pyplot <span class="keyword">import</span> MultipleLocator</span><br><span class="line"><span class="keyword">from</span> matplotlib.ticker <span class="keyword">import</span> MultipleLocator, FormatStrFormatter</span><br><span class="line"><span class="keyword">from</span> scipy.interpolate <span class="keyword">import</span> interp1d</span><br><span class="line"><span class="keyword">import</span> numpy <span class="keyword">as</span> np</span><br><span class="line"><span class="keyword">import</span> matplotlib.patches <span class="keyword">as</span> mpatches</span><br><span class="line"><span class="keyword">import</span> matplotlib</span><br><span class="line"><span class="keyword">from</span> scipy <span class="keyword">import</span> interpolate</span><br><span class="line"><span class="keyword">import</span> pylab <span class="keyword">as</span> pl</span><br><span class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> mpl</span><br><span class="line"><span class="keyword">import</span> random</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">from</span> mpl_toolkits.basemap <span class="keyword">import</span> Basemap</span><br><span class="line"><span class="keyword">import</span> math</span><br><span class="line"><span class="keyword">from</span> sklearn <span class="keyword">import</span> datasets</span><br><span class="line"><span class="keyword">from</span> matplotlib.colors <span class="keyword">import</span> ListedColormap, LinearSegmentedColormap</span><br><span class="line"><span class="keyword">from</span> scipy.ndimage.filters <span class="keyword">import</span> gaussian_filter</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'FangSong'</span>]</span><br><span class="line">matplotlib.rcParams[<span class="string">'font.sans-serif'</span>] = [<span class="string">'Times New Roman'</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line">fig = plt.figure(figsize=(<span class="number">5</span>, <span class="number">6</span>))</span><br><span class="line">fig.subplots_adjust(left=<span class="number">0.22</span>, bottom=<span class="number">0.18</span>, right=<span class="number">0.95</span>, top=<span class="number">0.73</span>)</span><br><span class="line">ax = fig.gca()</span><br><span class="line"></span><br><span class="line">fl = os.popen(<span class="string">"wc -l &lt;./dzx.txt"</span>)</span><br><span class="line">fw = os.popen(<span class="string">"wc -w &lt;./dzx.txt"</span>)</span><br><span class="line">data = np.loadtxt(<span class="string">"./dzx.txt"</span>)</span><br><span class="line">SC = np.loadtxt(<span class="string">"./SC-0.5.txt"</span>)</span><br><span class="line">nn = fl.read()</span><br><span class="line">nn = int(nn)</span><br><span class="line"><span class="comment">#print("nn=", nn)</span></span><br><span class="line">fsc = os.popen(<span class="string">"wc -w &lt;./SC-0.5.txt"</span>)</span><br><span class="line">nsc = fsc.read()</span><br><span class="line">nsc = int(nsc)</span><br><span class="line"><span class="comment">#print("nsc=", nsc)</span></span><br><span class="line">nt = fw.read()</span><br><span class="line">nt = int(nt)</span><br><span class="line">nt = nt / (nn * <span class="number">1</span>)</span><br><span class="line">nt = int(nt)</span><br><span class="line"><span class="comment">#print("nt=", nt)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># get maxium and minium of wind w</span></span><br><span class="line"><span class="comment"># ------------------------------------------------------</span></span><br><span class="line">WM = np.loadtxt(<span class="string">"./W-MIN-MAX-06:00.txt"</span>)</span><br><span class="line"></span><br><span class="line">w2dmax = np.empty([<span class="number">360</span>, <span class="number">360</span>], dtype=float)</span><br><span class="line">w2dmin = np.empty([<span class="number">360</span>, <span class="number">360</span>], dtype=float)</span><br><span class="line"></span><br><span class="line">ss = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">360</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">360</span>):</span><br><span class="line">        w2dmin[j, i] = WM[ss][<span class="number">2</span>]</span><br><span class="line">        w2dmax[j, i] = WM[ss][<span class="number">3</span>]</span><br><span class="line">        ss += <span class="number">1</span></span><br><span class="line">print(w2dmax)</span><br><span class="line"><span class="comment"># ------------------------------------------------------</span></span><br><span class="line"></span><br><span class="line">first = np.empty([nn], dtype=float)</span><br><span class="line">second = np.empty([nn], dtype=float)</span><br><span class="line">third = np.empty([nn], dtype=float)</span><br><span class="line">d = np.empty([nn], dtype=float)</span><br><span class="line">qg = np.empty([nn], dtype=float)</span><br><span class="line">qng = np.empty([nn], dtype=float)</span><br><span class="line">w = np.empty([nn], dtype=float)</span><br><span class="line">D = np.empty([<span class="number">360</span>, <span class="number">360</span>, <span class="number">35</span>], dtype=float)</span><br><span class="line">QNG = np.empty([<span class="number">360</span>, <span class="number">360</span>, <span class="number">35</span>], dtype=float)</span><br><span class="line">WW = np.empty([<span class="number">360</span>, <span class="number">360</span>, <span class="number">35</span>], dtype=float)</span><br><span class="line"></span><br><span class="line">first = data[<span class="number">0</span>:nn, <span class="number">1</span>]</span><br><span class="line">second = data[<span class="number">0</span>:nn, <span class="number">2</span>]</span><br><span class="line">third = data[<span class="number">0</span>:nn, <span class="number">3</span>]</span><br><span class="line">d = data[<span class="number">0</span>:nn, <span class="number">4</span>]</span><br><span class="line">qg = data[<span class="number">0</span>:nn, <span class="number">5</span>]</span><br><span class="line">qng = data[<span class="number">0</span>:nn, <span class="number">6</span>]</span><br><span class="line">w = data[<span class="number">0</span>:nn, <span class="number">7</span>]</span><br><span class="line"><span class="comment">#----------------------------------------------------------</span></span><br><span class="line"><span class="comment">#print(third.max())</span></span><br><span class="line"><span class="comment">#print(d.max())</span></span><br><span class="line"><span class="comment">#print(qg.max())</span></span><br><span class="line"><span class="comment">#print(qng.max())</span></span><br><span class="line"><span class="comment">#print(w.max())</span></span><br><span class="line"></span><br><span class="line">QNG[:, :, :] = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nsc):</span><br><span class="line">    QNG[int(second[int(SC[i])]),</span><br><span class="line">        int(first[int(SC[i])]),</span><br><span class="line">        int(third[int(SC[i])])] = qng[int(SC[i])]</span><br><span class="line"></span><br><span class="line">WW[:, :, :] = <span class="number">0</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(nn):</span><br><span class="line">    WW[int(second[i]), int(first[i]), int(third[i])] = w[i]</span><br><span class="line"></span><br><span class="line">q2d = np.amax(QNG, axis=<span class="number">2</span>)</span><br><span class="line">w2 = np.amax(WW, axis=<span class="number">2</span>)</span><br><span class="line">x = np.arange(<span class="number">0</span>, <span class="number">360</span>, <span class="number">1</span>)</span><br><span class="line">y = np.arange(<span class="number">0</span>, <span class="number">360</span>, <span class="number">1</span>)</span><br><span class="line">x_co = (<span class="number">107.0287</span> - <span class="number">104.9827</span>) / <span class="number">360</span></span><br><span class="line">y_co = (<span class="number">36.88075</span> - <span class="number">35.22662</span>) / <span class="number">360</span></span><br><span class="line">x = <span class="number">104.9827</span> + x * x_co</span><br><span class="line">y = <span class="number">35.22662</span> + y * y_co</span><br><span class="line">X, Y = np.meshgrid(x, y)</span><br><span class="line"><span class="comment">#print("q2dmin=", q2d.min())</span></span><br><span class="line"><span class="comment">#print("q2dmax=", q2d.max())</span></span><br><span class="line"><span class="comment">#sigma = 0.7</span></span><br><span class="line"><span class="comment">#q2d = gaussian_filter(q2d, sigma)</span></span><br><span class="line"></span><br><span class="line">sigma = <span class="number">0.9</span></span><br><span class="line">w2 = gaussian_filter(w2, sigma)</span><br><span class="line">w2dmin = gaussian_filter(w2dmin, sigma)</span><br><span class="line">w2dmax = gaussian_filter(w2dmax, sigma)</span><br><span class="line">print(len(w2[<span class="number">0</span>]))</span><br><span class="line">print(len(w2dmax[<span class="number">0</span>]))</span><br><span class="line">print(np.array(w2).max())</span><br><span class="line">print(np.array(w2dmax).max())</span><br><span class="line">print(np.array(w2dmin).min())</span><br><span class="line"></span><br><span class="line"><span class="comment">#levels_l = [0.1, 0.2, 0.3, 0.4, 0.5]</span></span><br><span class="line"><span class="comment">#levels_l = [1, 5, 10, 15, 20]</span></span><br><span class="line">levels_m = [<span class="number">-10</span>, <span class="number">-5</span>]</span><br><span class="line">levels_l = [<span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>]</span><br><span class="line"></span><br><span class="line">C2 = plt.contour(</span><br><span class="line">    X,</span><br><span class="line">    Y,</span><br><span class="line">    w2dmin,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="comment">#linestyles='-',</span></span><br><span class="line">    <span class="comment">#    colors=["#00ff33", "#ffff00", "#ff9933", "red", "#cc00ff"],</span></span><br><span class="line">    colors=[<span class="string">"black"</span>, <span class="string">"gray"</span>],</span><br><span class="line">    <span class="comment">#                linewidths=np.arange(0.4, 2.4, 0.4))</span></span><br><span class="line">    linestyles=<span class="string">':'</span>,</span><br><span class="line">    linewidths=<span class="number">0.7</span>,</span><br><span class="line">    levels=levels_m)</span><br><span class="line"></span><br><span class="line">C = plt.contour(</span><br><span class="line">    X,</span><br><span class="line">    Y,</span><br><span class="line">    w2dmax,</span><br><span class="line">    <span class="number">4</span>,</span><br><span class="line">    <span class="comment">#    colors=["#FFC0CB", "#B03060", "red", "#A020F0", "#8A2BE2"],</span></span><br><span class="line">    colors=[<span class="string">"gray"</span>, <span class="string">"black"</span>, <span class="string">"lightblue"</span>, <span class="string">"blue"</span>],</span><br><span class="line">    <span class="comment">#                linewidths=np.arange(0.4, 2.4, 0.4))</span></span><br><span class="line">    linewidths=<span class="number">0.7</span>,</span><br><span class="line">    levels=levels_l)</span><br><span class="line"></span><br><span class="line"><span class="comment">#labels = [</span></span><br><span class="line"><span class="comment">#    '1m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$', '5m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$',</span></span><br><span class="line"><span class="comment">#    '10m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$', '15m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$',</span></span><br><span class="line"><span class="comment">#    '20m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span></span><br><span class="line"><span class="comment">#]</span></span><br><span class="line">labels = [</span><br><span class="line">    <span class="string">'5m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span>, <span class="string">'10m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span>,</span><br><span class="line">    <span class="string">'15m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span>, <span class="string">'20m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">labels2 = [<span class="string">'-10m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span>, <span class="string">'-5m.$\mathregular&#123;&#123;s^&#123;-1&#125;&#125;&#125;$'</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(labels2)):</span><br><span class="line">    C2.collections[i].set_label(labels2[i])</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, len(labels)):</span><br><span class="line">    C.collections[i].set_label(labels[i])</span><br><span class="line"></span><br><span class="line"><span class="comment">#plt.clabel(C, inline=1, fontsize=10)</span></span><br><span class="line">cmap = ListedColormap(</span><br><span class="line">    [<span class="string">"white"</span>, <span class="string">"#1aad19"</span>, <span class="string">"#99ff33"</span>, <span class="string">"#ffff00"</span>, <span class="string">"#ff9933"</span>, <span class="string">"red"</span>])</span><br><span class="line"><span class="comment">#plot_examples([cmap])</span></span><br><span class="line"><span class="comment">#levels = [0, 4, 8, 12, 16, 20, 24]</span></span><br><span class="line">levels = [<span class="number">0</span>, <span class="number">1000</span>, <span class="number">5000</span>, <span class="number">10000</span>, <span class="number">100000</span>, <span class="number">500000</span>, <span class="number">1000000</span>]</span><br><span class="line">q2d = np.where(q2d, q2d, np.nan)</span><br><span class="line">im = plt.contourf(</span><br><span class="line">    X,</span><br><span class="line">    Y,</span><br><span class="line">    q2d,</span><br><span class="line">    <span class="number">8</span>,</span><br><span class="line">    colors=[<span class="string">"#1aad19"</span>, <span class="string">"#00ff33"</span>, <span class="string">"#ffff00"</span>, <span class="string">"#ff9933"</span>, <span class="string">"red"</span>, <span class="string">"#cc00ff"</span>],</span><br><span class="line">    levels=levels[:])</span><br><span class="line"><span class="comment">#    extend='both')</span></span><br><span class="line"></span><br><span class="line">iw = np.where((q2d[:, :] &gt;= <span class="number">1000</span>) &amp; (q2d[:, :] &lt;= <span class="number">5000</span>))</span><br><span class="line">iw0 = np.array(iw[<span class="number">0</span>])</span><br><span class="line">iw1 = np.array(iw[<span class="number">1</span>])</span><br><span class="line"><span class="comment">#print(iw0)</span></span><br><span class="line"><span class="comment">#print(iw1)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 坐标边框设置</span></span><br><span class="line">ax.set_xlabel(<span class="string">"Longtitude"</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">ax.set_ylabel(<span class="string">"Latitude"</span>, fontsize=<span class="number">25</span>)</span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">1</span>) <span class="comment">#x interval</span></span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">1</span>) <span class="comment">#y interval</span></span><br><span class="line">ax = plt.gca()</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"></span><br><span class="line">x_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.xaxis.set_major_locator(x_major_locator)</span><br><span class="line">y_major_locator = MultipleLocator(<span class="number">0.50</span>)</span><br><span class="line">ax.yaxis.set_major_locator(y_major_locator)</span><br><span class="line"><span class="comment">#禁用标签偏移量http://www.voidcn.com/article/p-ehmibndo-bsw.html</span></span><br><span class="line">ax.ticklabel_format(style=<span class="string">'sci'</span>, useOffset=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">plt.tick_params(labelsize=<span class="number">18</span>)</span><br><span class="line">labels = ax.get_xticklabels() + ax.get_yticklabels()</span><br><span class="line">[label.set_fontname(<span class="string">'Times New Roman'</span>) <span class="keyword">for</span> label <span class="keyword">in</span> labels]</span><br><span class="line"><span class="comment">#plt.subplots_adjust(left=0.21, bottom=0.185)</span></span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.yaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.yaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line"><span class="keyword">for</span> tick <span class="keyword">in</span> ax.xaxis.get_major_ticks()[:]:</span><br><span class="line">    tick.set_pad(<span class="number">12</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> ax.xaxis.get_ticklines():</span><br><span class="line">    <span class="comment"># line is a Line2D instance</span></span><br><span class="line">    line.set_color(<span class="string">'black'</span>)</span><br><span class="line">    line.set_markersize(<span class="number">7</span>)</span><br><span class="line">    line.set_markeredgewidth(<span class="number">2</span>)</span><br><span class="line">bwith = <span class="number">2</span> <span class="comment">#边框宽度设置为1x.spines['bottom'].set_linewidth(bwith)</span></span><br><span class="line">ax.spines[<span class="string">'left'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'top'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'right'</span>].set_linewidth(bwith)</span><br><span class="line">ax.spines[<span class="string">'bottom'</span>].set_linewidth(bwith)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 设置图片标签</span></span><br><span class="line">ax.legend(fontsize=<span class="number">11</span>,</span><br><span class="line">          loc=<span class="string">'lower center'</span>,</span><br><span class="line">          bbox_to_anchor=(<span class="number">0.10</span>, <span class="number">1.02</span>, <span class="number">0.5</span>, <span class="number">0.5</span>),</span><br><span class="line">          frameon=<span class="literal">True</span>,</span><br><span class="line">          fancybox=<span class="literal">True</span>,</span><br><span class="line">          framealpha=<span class="number">0.2</span>,</span><br><span class="line">          borderpad=<span class="number">0.3</span>,</span><br><span class="line">          ncol=<span class="number">3</span>,</span><br><span class="line">          markerfirst=<span class="literal">True</span>,</span><br><span class="line">          markerscale=<span class="number">1</span>,</span><br><span class="line">          numpoints=<span class="number">1</span>,</span><br><span class="line">          handlelength=<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line">position1 = fig.add_axes([<span class="number">0.15</span>, <span class="number">0.95</span>, <span class="number">0.7</span>, <span class="number">0.03</span>])</span><br><span class="line">cb = plt.colorbar(im, cax=position1, orientation=<span class="string">'horizontal'</span>) <span class="comment">#方向</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加地图</span></span><br><span class="line"><span class="comment">#fig = plt.figure()</span></span><br><span class="line">ax = fig.add_axes([<span class="number">0.22</span>, <span class="number">0.179</span>, <span class="number">0.73</span>, <span class="number">0.55</span>], frameon=<span class="literal">False</span>)</span><br><span class="line">ax.set_alpha(<span class="number">0</span>)</span><br><span class="line">m = Basemap(projection=<span class="string">'mill'</span>,</span><br><span class="line">            llcrnrlat=<span class="number">35.227</span>,</span><br><span class="line">            llcrnrlon=<span class="number">104.98</span>,</span><br><span class="line">            urcrnrlon=<span class="number">107.03</span>,</span><br><span class="line">            urcrnrlat=<span class="number">36.88</span>)</span><br><span class="line">m.readshapefile(<span class="string">'help/gadm36_CHN_shp/gadm36_CHN_1'</span>, <span class="string">'china'</span>,</span><br><span class="line">                linewidth=<span class="number">2</span>) <span class="comment">#读取省份数据</span></span><br><span class="line">m.readshapefile(<span class="string">'help/gadm36_TWN_shp/gadm36_TWN_1'</span>, <span class="string">'tw'</span>, linewidth=<span class="number">2</span>) <span class="comment">#读取台湾的数据</span></span><br><span class="line">m.ax = ax</span><br><span class="line"></span><br><span class="line">plt.savefig(<span class="string">"./dzx-qg.png"</span>, dpi=<span class="number">500</span>)</span><br><span class="line"><span class="comment">#plt.show()</span></span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://chidiangongzi.github.io/blog/2022/06/21/%E6%AF%95%E4%B8%9A%E8%84%9A%E6%9C%AC%E6%95%B4%E7%90%86/" data-id="cl4nswnp6001g4kczedpn7wu9" class="article-share-link">分享</a>
      
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/blog/tags/python/" rel="tag">python</a></li></ul>

    </footer>
  </div>
  
    
 
<script src="/blog/jquery/jquery.min.js"></script>

  <div id="random_posts">
    <h2>推荐文章</h2>
    <div class="random_posts_ul">
      <script>
          var random_count =4
          var site = {BASE_URI:'/blog/'};
          function load_random_posts(obj) {
              var arr=site.posts;
              if (!obj) return;
              // var count = $(obj).attr('data-count') || 6;
              for (var i, tmp, n = arr.length; n; i = Math.floor(Math.random() * n), tmp = arr[--n], arr[n] = arr[i], arr[i] = tmp);
              arr = arr.slice(0, random_count);
              var html = '<ul>';
            
              for(var j=0;j<arr.length;j++){
                var item=arr[j];
                html += '<li><strong>' + 
                item.date + ':&nbsp;&nbsp;<a href="' + (site.BASE_URI+item.uri) + '">' + 
                (item.title || item.uri) + '</a></strong>';
                if(item.excerpt){
                  html +='<div class="post-excerpt">'+item.excerpt+'</div>';
                }
                html +='</li>';
                
              }
              $(obj).html(html + '</ul>');
          }
          $('.random_posts_ul').each(function () {
              var c = this;
              if (!site.posts || !site.posts.length){
                  $.getJSON(site.BASE_URI + 'js/posts.js',function(json){site.posts = json;load_random_posts(c)});
              } 
               else{
                load_random_posts(c);
              }
          });
      </script>
    </div>
  </div>

    
<nav id="article-nav">
  
  
    <a href="/blog/2022/04/06/UCLALES-SALSA/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">下一篇</strong>
      <div class="article-nav-title">UCLALES-SALSA MODEL安装</div>
    </a>
  
</nav>

  
</article>
 
     
  <div class="comments" id="comments">
    
     
       
      <div id="cloud-tie-wrapper" class="cloud-tie-wrapper"></div>
    
       
      
      
  </div>
 
  

</section>
           
    <aside id="sidebar">
  
    
    <div class="widget-wrap">
    
      <div class="widget" id="toc-widget-fixed">
      
        <strong class="toc-title">文章目录</strong>
        <div class="toc-widget-list">
              <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#K值与SSE关系线"><span class="toc-number">1.</span> <span class="toc-text">K值与SSE关系线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#冰雹轨迹各变量时间序列图"><span class="toc-number">2.</span> <span class="toc-text">冰雹轨迹各变量时间序列图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#冰雹轨迹投影绘图"><span class="toc-number">3.</span> <span class="toc-text">冰雹轨迹投影绘图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#冰雹轨迹散点图"><span class="toc-number">4.</span> <span class="toc-text">冰雹轨迹散点图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#四组CCN的箱线图"><span class="toc-number">5.</span> <span class="toc-text">四组CCN的箱线图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#柱状图-子图"><span class="toc-number">6.</span> <span class="toc-text">柱状图-子图</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#雹胚等值线-上升气流图"><span class="toc-number">7.</span> <span class="toc-text">雹胚等值线+上升气流图</span></a></li></ol>
          </div>
      </div>
    </div>

  
    

  
    
  
    
  
    

  
    
  
</aside>

      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-left">
      &copy; 2014 - 2022 pro^w^&nbsp;|&nbsp;
      主题 <a href="https://github.com/giscafer/hexo-theme-cafe/" target="_blank">Cafe</a>
    </div>
     <div id="footer-right">
      联系方式&nbsp;|&nbsp;2602005529@qq.com
    </div>
  </div>
</footer>
 
<script src="/blog/jquery/jquery.min.js"></script>

    </div>
    <nav id="mobile-nav">
  
    <a href="/blog/" class="mobile-nav-link">首页</a>
  
    <a href="/blog/archives" class="mobile-nav-link">归档</a>
  
    <a href="/blog/about" class="mobile-nav-link">关于</a>
  
</nav>
    <img class="back-to-top-btn" src="/images/fly-to-top.png"/>
<script>
// Elevator script included on the page, already.
window.onload = function() {
  var elevator = new Elevator({
    selector:'.back-to-top-btn',
    element: document.querySelector('.back-to-top-btn'),
    duration: 1000 // milliseconds
  });
}
</script>
      

  
    <script>
      var cloudTieConfig = {
        url: document.location.href, 
        sourceId: "",
        productKey: "e2fb4051c49842688ce669e634bc983f",
        target: "cloud-tie-wrapper"
      };
    </script>
    <script src="https://img1.ws.126.net/f2e/tie/yun/sdk/loader.js"></script>
    

  







<!-- author:forvoid begin -->
<!-- author:forvoid begin -->

<!-- author:forvoid end -->

<!-- author:forvoid end -->


  
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
        }
      })
    </script>

    <script type="text/x-mathjax-config">
      MathJax.Hub.Queue(function() {
        var all = MathJax.Hub.getAllJax(), i;
        for (i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
        }
      })
    </script>
    <script type="text/javascript" src="https://cdn.rawgit.com/mathjax/MathJax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
  


 
<script src="/blog/js/is.js"></script>



  
<link rel="stylesheet" href="/blog/fancybox/jquery.fancybox.css">

  
<script src="/blog/fancybox/jquery.fancybox.pack.js"></script>




<script src="/blog/js/script.js"></script>


<script src="/blog/js/elevator.js"></script>

  </div>
</body>
</html>